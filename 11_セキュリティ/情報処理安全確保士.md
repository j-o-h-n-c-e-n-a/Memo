# 試験対策
 1. 模範解答と自分の解答を比較し、不足部分等を補完する。
 2. 問題のストーリーを把握する
 3. ネットワーク構成を把握する
 4. 問題の意図を理解する
 5. 意図した解答を用意する（1．へ繋がる）

# 午後１対策
## ウィルス対策
##### H.26秋Ⅰ
    バッファオーバーフロー攻撃によるスマホのルート特権化について出題
1. 
    * バッファオーバーフロー攻撃
        - スタック領域、ヒープ領域、静的領域を標的とする
        - 対策
            + 入力データのチェックを厳格に行う
            + 危険な関数は使わない
            + 低級言語を使わない
    * return to libc 攻撃
        - C言語の標準ライブラリへのアドレスジャンプによるデータ実行防止機能の回避
2. 
    * データ実行防止機能の適用箇所：スタック領域
    * アドレス空間配置ランダム化技術：return to libc攻撃対策、ジャンプ先アドレスを特定させない
3. 
    * Webサーバーへのバッファオーバーフロー攻撃：インジェクションから発生⇒IPSやWAFで検知・破棄する
    * ルート特権化されると、あらゆる命令の実行がShellコードで可能となる
4. 
    * スマホのルート特権ではアプリデータにアクセス可能
    * 意図しないルート特権化が起こるのは、マルウェアに感染したとき
    * スマホの管理には、遠隔でスマホのOSやアプリのバージョンなどの構成情報を管理することや紛失時のデータ消去などが可能なシステムを導入するとよい

##### H.29秋Ⅰ

### マルウェア
##### H.27秋Ⅱ
##### H.29春Ⅱ

#### CPU脆弱性
* 冥闘士
* メルトダウン

### ランサムウェア
##### H.29秋Ⅰ

## インジェクション脆弱性
##### H.26秋Ⅱ：SQL
    対策としては、バリデーションによる入力確認とサニタイジングによる出力内容の無害化を行う
1. 
    * WebサイトのHTTPステータスコード
    * サイト全体にも脆弱性が存在する可能性がある場合、キチンと対策する
    * インシデント対応では事故発生について、なるべく早く報告する
2. 
    * 外部の監査人が診断ツールを使用して検査をする場合、診断ツールの通信を遮断しないように設定する
    * F/Wの内側で行う診断において、対策の優先度を下げても良いのは、F/Wにて遮断する設定（IPアドレスやポート）が行われている攻撃に関する脆弱性となる
    * プログラム修正を行った場合、別の脆弱性を作りこんでいないか確認する必要がある
3. 
    * Location.hashは、URLのフラグメント識別子(#〜)の部分を取得する
    * 反射型XSSの診断方法：スクリプトを含むデータをWebアプリに入力し、それがWebサイトからの応答中に出力されているかを確認する
    * DOMベースXSSの場合、Webサイトからの応答中に不正なスクリプトが含まれていないため、反射型XSSの診断方法では確認できない
    * X-FRAME-OPTIONSヘッダ
        + DENY：フレーム内のページ表示を全ドメインで禁止
        + SAMEORIGIN：同一ドメイン内のみ表示を許可
        + ALLOW FROM <URI>：指定のドメインのみ表示を許可
    * HSTS：常時SSLサイトにおいて、サイト閲覧者がURL直打ちなどでhttp接続しようとした際、強制的にhttpsへ接続させる機能のこと
        + 初回のみHTTPでアクセスしてしまうので、プリロードHSTS（ブラウザ側に予めhttps接続するWEBサイトのURL情報を伝えておく）を利用する

##### H.27春Ⅰ：HTTPヘッダ
1. HTTPS通信でセッションIDが漏れるケース

* １つのホストの中でHTTPとHTTPSのページ間を行き来する
    - 対策：HTTPSのCookieにsecure属性をつける
* ログイン前のHTTPのページで既にセッションIDを発行しており、ログイン後も同セッションIDを使用する
    - 対策：ログインするまでセッションIDを持たないかログイン時に新たにセッションを発行する

2. HTTPヘッダインジェクション
    - HTTPのリクエストボディ内の値をレスポンスヘッダ内で使用する場合に、その値が改行文字を２つ以上含むと、その改行文字以降の部分がレスポンスボディとして扱われ、意図しないページが表示されてしまう攻撃
    - 対策
        + リクエストボディの値をレスポンスヘッダで使用しない
        + 改行コードをエスケープする。（他の文字に置換もしくは削除）

3. セッションフィクセーション
    - 攻撃者があるWebサイトで取得したセッションIDをWebサイトの利用者に強制的に使用させる攻撃
    - 対策：対策として毎回新しいセッションIDを使用する

### メールヘッダー
    宛先メールアドレスの改ざん対策には、複数のアドレス入力を許可しない等がある

### ブラウザ
#### XSS
    テキストボックス等でスクリプトの入力を禁止する
    スクリプトで使用される「<」「>」「&」のような特殊文字を削除または置換する（無害化）
##### H.28春Ⅰ
1. XSS脆弱性と修正方法
* Same Origin Policy
    + あるオリジン（http or https, ホスト名, ポート番号）で読み込まれた文章やスクリプトを他のオリジンからアクセス出来ないよう制御する仕組み
2. CSRF脆弱性と修正方法
* 対策としては、フォームを表示するプログラム側によって推定困難なランダム値を hiddenフィールドとして埋め込んで送信し、フォームデータを処理する側でそのランダム値がフォームデータ内に含まれていることを確認する方法がある
3. 脆弱性の再発防止策
* サーバーサイドでも入力値の確認を行うこと
##### H.29秋Ⅰ
##### H.25秋Ⅰ
##### H.29春Ⅰ：CSRF
    リクエスト強要への対策

#### 権限昇格
##### H.27春Ⅰ：パスワードへの攻撃
1. レインボーテーブル
2. 
* SHA-256(bit)
3. パスワードの組み合わせ
4. 他のサイトから抽出した利用者IDとパスワードの組み合わせによるパスワード攻撃に対しての注意喚起


## PKI
##### H.26秋Ⅰ：暗号
1. 
    * 暗号のビット長
        - RSA（素因数分解問題）：2048bit以上（4096bit推奨）
            + 256ビット安全性で鍵長15360
        - ECDSA（楕円曲線DSA）：256bit以上（←現在はこの暗号方式が推奨）
            + 256ビット安全性で鍵長512
        - ハッシュ関数（SHA）：256bit以上（現在、SHA-1規格は廃止）
            + 256ビット安全性で鍵長512
    * 暗号の危殆化による有効期限
        - 暗号には各セキュリティ強度毎に利用終了の目安が設定されている
2. 
    * 端末に発行された証明書の利用停止を申請
        - SSLクライアント認証
    * 公開鍵認証基盤
        - 所有者⇒公開鍵（ディジタル署名）⇒認証局
    * 受付拒否リスト
        - 識別番号の登録
3. 運用の話

##### H.28春Ⅰ：サーバー証明書
1. 
    * FQDN⇒DNS
    * 有効期間
    * サーバー認証の不正検出が目的なので、有効期限は切れている必要がある
2. 各検証不備で認証が成功してしまうパターン
    * 発行者の検証不備　⇒　発行者が商用認証局でなくても認証出来てしまう
    * コモンネームの検証不備　⇒　コモンネームがSサーバのFQDNでなくても認証出来てしまう

##### H.29秋Ⅰ

## 標的型攻撃
### Bot
##### H.27秋Ⅱ

### メール
##### H.26春Ⅰ
##### H.24秋Ⅰ

## サーバー要塞化
### ネットワーク
#### FW
#### DMZ
#### IoT機器
##### DDos攻撃への対処
##### ネットワークカメラへの対処
##### SSH,Telnet,FTPポートへの対処