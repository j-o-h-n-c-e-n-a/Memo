# 試験対策
 1. 模範解答と自分の解答を比較し、不足部分等を補完する。
 2. 問題のストーリーを把握する
 3. ネットワーク構成を把握する
 4. 問題の意図を理解する
 5. 意図した解答を用意する（1．へ繋がる）

# 午後１対策
## ウィルス対策
##### H.26秋 問1
    バッファオーバーフロー攻撃によるスマホのルート特権化について出題
1. 
    * バッファオーバーフロー攻撃
        - スタック領域、ヒープ領域、静的領域を標的とする
        - 対策
            + 入力データのチェックを厳格に行う
            + 危険な関数は使わない
            + 低級言語を使わない
    * return to libc 攻撃
        - C言語の標準ライブラリへのアドレスジャンプによるデータ実行防止機能の回避
2. 
    * データ実行防止機能の適用箇所：スタック領域でのコード実行を禁止
    * アドレス空間配置ランダム化技術：return to libc攻撃対策、ジャンプ先アドレスを特定させない
3. 
    * Webサーバーへのバッファオーバーフロー攻撃：インジェクションから発生⇒IPSやWAFで検知・破棄する
    * ルート特権化されると、あらゆる命令の実行がShellコードで可能となる
4. 
    * スマホのルート特権ではアプリデータにアクセス可能
    * 意図しないルート特権化が起こるのは、マルウェアに感染したとき
    * スマホの管理には、遠隔でスマホのOSやアプリのバージョンなどの構成情報を管理することや紛失時のデータ消去などが可能なシステムを導入するとよい


### マルウェア
##### H.30春 問2
    情報セキュリティ対策の強化が題材
    同業他社で運用担当者のPCがマルウェアに感染してしまったので弊社もセキュリティ強化を行うという内容
1. 
    * TXTレコード、SPFレコード：許可するサーバーを記載
    * FWのフィルタリングルール
2. 
    * オープンリゾルバ：アクセス元の制限が無く、どこからでも利用可能なDNSキャッシュサーバのこと。外部からのDDos攻撃の対象となる
3. 

#### CPU脆弱性
* 冥闘士
    + CPUのキャッシュを利用した分析プログラムを実行する
* メルトダウン
    + アウトオブオーダー実行
* 変異
    + 投機的予測を使った最適化に係る部分を狙ったもの
    + メルトダウン類似のもの

### ランサムウェア
    ソフトウェア脆弱性、通信制御、ウィルス対応、バックアップが重要
##### H.29秋 問1
1. 
    * 
2. 
    * RLO
    * メールヘッダ情報
3. 
4. 
    * 問題として挙げれられているサーバの特徴
    * マルウェアの特徴

## インジェクション脆弱性
##### H.27春 問1：HTTPヘッダ
    題材は、Webサイトの脆弱性と対策について
    脆弱性検査サービス会社の社内技能試験で、受験者が試験用Webサイトを操作後、HTTPヘッダインジェクションやセッションフィクセーションなどのWebサイトが持つ脆弱性を指摘し、対策を提案するという内容
1. HTTPS通信でセッションIDが漏れるケース

* １つのホストの中でHTTPとHTTPSのページ間を行き来する
    - 対策：HTTPSのCookieにsecure属性をつける
* ログイン前のHTTPのページで既にセッションIDを発行しており、ログイン後も同セッションIDを使用する
    - 対策：ログインするまでセッションIDを持たないかログイン時に新たにセッションを発行する

2. HTTPヘッダインジェクション
    - HTTPのリクエストボディ内の値をレスポンスヘッダ内で使用する場合に、その値が改行文字を２つ以上含むと、その改行文字以降の部分がレスポンスボディとして扱われ、意図しないページが表示されてしまう攻撃
    - 対策
        + リクエストボディの値をレスポンスヘッダで使用しない
        + 改行コードをエスケープする。（他の文字に置換もしくは削除）

3. セッションフィクセーション
    - 攻撃者があるWebサイトで取得したセッションIDをWebサイトの利用者に強制的に使用させる攻撃
    - 対策：対策として毎回新しいセッションIDを使用する

### メールヘッダー
    宛先メールアドレスの改ざん対策には、複数のアドレス入力を許可しない等がある

### Webアプリケーション
##### H.28春 問1
    題材は、懸賞応募のWebサイトの脆弱性について
    開発中のWebサイトの脆弱性検査で、これらの脆弱性が指摘され、その修正を実施すると共に今後の開発時に同様の脆弱性が組み込まれないように再発防止策を検討するという内容
1. XSS脆弱性と修正方法
* XSS
    テキストボックス等でスクリプトの入力を禁止する
    スクリプトで使用される「<」「>」「&」のような特殊文字を削除または置換する（無害化）
* Same Origin Policy
    + あるオリジン（http or https, ホスト名, ポート番号）で読み込まれた文章やスクリプトを他のオリジンからアクセス出来ないよう制御する仕組み
2. CSRF脆弱性と修正方法
* 対策としては、フォームを表示するプログラム側によって推定困難なランダム値を hiddenフィールドとして埋め込んで送信し、フォームデータを処理する側でそのランダム値がフォームデータ内に含まれていることを確認する方法がある
3. 脆弱性の再発防止策
* サーバーサイドでも入力値の確認を行うこと

##### H.29秋 問2
    アプリケーションのセキュリティ対策が題材
    他社のインシデント増加に伴い、自社サイトのセキュリティ強化を行うといった内容
1. 
    * SQLインジェクション
        + プリペアードを使っていない所
    * XSS
        + println
    * エスケープ処理
2. 
    * secure属性：TLS通信時だけCookieを送信
    * HTTPOnly属性：Http通信時のみCookieにアクセスできる
    * オープンリダイレクト：ユーザによってリダイレクト先を決めることができる脆弱性
        + 対策：ホワイトリスト方式によるリダイレクト機能（リダイレクト先を予め許可されたURLに限定する）
3. 
    * XSS攻撃はブラウザによっては、遮断する機能を持っているため、テスト時にアプリケーションの脆弱性に気づかない恐れがある
    * サイトの未対応な脆弱性を突かれるのを軽減する対策
        + WAFの導入

##### H.25秋
##### H.29春：CSRF
    リクエスト強要への対策

#### 権限昇格
##### H.27春 問3：パスワードへの攻撃
    題材は、パスワードへの攻撃
    ショッピングサイトが大量のログイン試行により一部ユーザのIDとパスワードが破られるという攻撃を受けます。当該サイトでは以下のアカウント管理の問題点があり、改善案と改善案実装までの暫定処置について検討するという内容

1. レインボーテーブル
    + 想定される全ての文字列に対するハッシュ値を求めたリスト
        - ハッシュ化されたパスワードファイルが流出した場合に、レインボーテーブルと突合して、パスワードを短時間で推測される恐れがある
    + 対策：ソルトの付与
2. 
    * SHA-256(bit)
    * FWのルール設定による大量のログイン試行の遮断と不完全な部分 
3. パスワードの組み合わせ
4. 他のサイトから抽出した利用者IDとパスワードの組み合わせによるパスワード攻撃に対しての注意喚起


## PKI
##### H.26秋 問2：暗号
    題材は、代理店販売支援システムの利用者認証について、
    代理店販売支援システムの拡張にあたり、セキュリティ強化の方針として利用者認証強化、アクセス端末の限定、利用ガイドラインの作成について設計・検討するという内容。
1. 
    * 暗号のビット長
        - RSA（素因数分解問題）：2048bit以上（4096bit推奨）
            + 256ビット安全性で鍵長15360
        - ECDSA（楕円曲線DSA）：256bit以上（←現在はこの暗号方式が推奨）
            + 256ビット安全性で鍵長512
        - ハッシュ関数（SHA）：256bit以上（現在、SHA-1規格は廃止）
            + 256ビット安全性で鍵長512
    * 暗号の危殆化による有効期限
        - 暗号には各セキュリティ強度毎に利用終了の目安が設定されている
2. 
    * 端末に発行された証明書の利用停止を申請
        - SSLクライアント認証
    * 公開鍵認証基盤
        - 所有者⇒公開鍵（ディジタル署名）⇒認証局
    * 受付拒否リスト
        - 識別番号の登録
3. 運用の話

##### H.28春 問3：サーバー証明書
    題材はショッピングサイト用スマホアプリとサーバ間の認証について
1. 
    * FQDN⇒DNS
    * 有効期間
    * サーバー認証の不正検出が目的なので、有効期限は切れている必要がある
2. 各検証不備で認証が成功してしまうパターン
    * 発行者の検証不備　⇒　発行者が商用認証局でなくても認証出来てしまう
    * コモンネームの検証不備　⇒　コモンネームがSサーバのFQDNでなくても認証出来てしまう

##### H.29秋 問3：SSL/TLS
    秘密鍵の危殆化について
1. 
    * ディジタル証明書：改ざんされていないことの証明
    * SSL/TLS
        + 公開鍵で暗号化した共通鍵で平文をやり取りする
    * サーバー証明書の認証レベル
        + ドメイン認証
        + 企業認証
        + EV認証
    * DNSキャッシュポイズニング
2. 
    * サーバー証明書が無効になった場合
        + サーバー証明書の利用停止
        + 失効申請
3. 
    * SSL3.0の脆弱性：POODLE攻撃

## 標的型攻撃
    マルウェア感染、メール対策、ソフトウェアの脆弱性対策、ログの監視、組織体制
### Bot

### メール
    従業員への周知徹底、情報共有、金銭処理のチェック体制強化、なりすまし対策強化

##### H.26春 問3
    題材は、マルウェア感染への対応について、
    社内ネットワークのPCからマルウェアが検出されたため、感染経路・被害の調査を行うとともに、今後の対策として社内機器のフィルタリングルールやアクセス制御、パスワード格納の設定を見直すという内容
1. 
    * フィルタリングルール
        + ブラックリスト方式
        + ホワイトリスト方式
2. 
    * マルウェアの動作
        + ポート利用
            - FWのフィルタリングルールで遮断する
    * プロキシサーバについて
3. 
    * ネットワークセグメントの把握
        + FW通信方向の可否
    * ソフトウェア脆弱性を利用したマルウェア感染のリスク低減
        + サーバーに不要なソフトウェアはインストールしない
4. 
    * パスワード脆弱性とハッシュ値
    * ソルト
        + 「ユーザごとにソルト（文字列）を用意」し、ハッシュ計算時にパスワードの前後にソルトを付加することで「同じパスワードでもハッシュ値を変える方法」

##### H.24秋

## サーバー要塞化
    脆弱性対策、情報資産の把握と管理、速やかな実施、最新パッチの適用、WAF,IPSの導入
## ネットワーク
### FW・DMZ・Proxy
    Web,DNS,Mail用の各サーバーについて押える
##### H.27春 問2
    題材は、情報漏洩インシデントの調査
    セキュリティ情報共有団体からの連絡で社内機器がC&Cサーバと通信していた事が判明。調査の結果、ある従業員の業務PCがマルウェアに感染し、プロキシサーバを経由してC&Cサーバにアクセスしていた事が分かり、暫定対応や再発防止策を実施するという内容
1. 
    * 通信ログがあれば確認する
    * 通信経路の把握
2. 
    * FQDNとDNSの名前解決
    * 名前解決と宛先IPの関係について
    * FWで通信遮断できない場合のプロキシサーバでのURLフィルタリング
3. 
    * 脆弱性のあるサーバの内、ウィルス拡散の可能性があるサーバの確認
    * 
    * ログの改ざん対策の一つ
        + バックアップと比較する

##### H.28春 問2：メール認証
    題材は、DMZ上の機器のセキュリティについて
    情報セキュリティ強化のため、DMZに設置しているプロキシサーバや外部メールサーバの設定を確認したところ、DNSキャッシュポイズニング攻撃やマルウェア感染の脅威に対する脆弱性が見つかり、対策を実施するという内容

1. 
    * オープンリレー
        + メールサーバが外部NWからの送信依頼を受付ける設定になっているもの
        + この設定をすると大量の迷惑メールを送信する際の踏み台としてメールサーバが利用されてしまいます
    * 送信ドメイン認証技術
        + 迷惑メールはほとんどが送信元を偽装して送信されます。そのような迷惑メールを防止するための技術
            - SPF：送信ドメイン認証には、送信元IPアドレスを元に検証する
            - DKIM：Sender IDと送信メールのヘッダに付与された電子署名を元に検証する
2. 
    * オープンリゾルバ
        + DNSサーバで所属NW以外のNWからの問合せにも応答する設定となっているもの
    * DNSリフレクション攻撃
        + オープンリゾルバが有効になっているDNSサーバに攻撃対象のIPアドレスを送信元として偽装したDNSリクエストを大量に送り、DNSサーバが踏み台となって攻撃対象にDNSパケットを送信させられる攻撃
3. 
    * DNSキャッシュポイズニング攻撃
        + DNSキャッシュポインズニングの第一段階である偽の応答が本来の応答（権威サーバからの応答）と混同されてしまう可能性を下げる為にDNS問合せ時の送信元ポート番号をランダム化する方法がある（ただし、ポート番号を総当たりされると一致する場合があるので完ぺきではない）
4. 外部メールサーバ
    * 対策の実施
        + SPFによる判定：送信元アドレス認証
        + ブラックリスト判定

### IoT機器
#### DDos攻撃への対処
#### ネットワークカメラへの対処
#### SSH,Telnet,FTPポートへの対処

# 午後２対策
### マルウェア
##### H.27秋 問1
    題材は、マルウェアによる情報漏えいへの対策、シンクライアント技術及びその他のセキュリティ対策技術について

##### H.29春

## インジェクション脆弱性
##### H.26秋：SQL
    対策としては、バリデーションによる入力確認とサニタイジングによる出力内容の無害化を行う
1. 
    * WebサイトのHTTPステータスコード
    * サイト全体にも脆弱性が存在する可能性がある場合、キチンと対策する
    * インシデント対応では事故発生について、なるべく早く報告する
2. 
    * 外部の監査人が診断ツールを使用して検査をする場合、診断ツールの通信を遮断しないように設定する
    * F/Wの内側で行う診断において、対策の優先度を下げても良いのは、F/Wにて遮断する設定（IPアドレスやポート）が行われている攻撃に関する脆弱性となる
    * プログラム修正を行った場合、別の脆弱性を作りこんでいないか確認する必要がある
3. 
    * Location.hashは、URLのフラグメント識別子(#〜)の部分を取得する
    * 反射型XSSの診断方法：スクリプトを含むデータをWebアプリに入力し、それがWebサイトからの応答中に出力されているかを確認する
    * DOMベースXSSの場合、Webサイトからの応答中に不正なスクリプトが含まれていないため、反射型XSSの診断方法では確認できない
    * X-FRAME-OPTIONSヘッダ
        + DENY：フレーム内のページ表示を全ドメインで禁止
        + SAMEORIGIN：同一ドメイン内のみ表示を許可
        + ALLOW FROM <URI>：指定のドメインのみ表示を許可
    * HSTS：常時SSLサイトにおいて、サイト閲覧者がURL直打ちなどでhttp接続しようとした際、強制的にhttpsへ接続させる機能のこと
        + 初回のみHTTPでアクセスしてしまうので、プリロードHSTS（ブラウザ側に予めhttps接続するWEBサイトのURL情報を伝えておく）を利用する

## 予想問題
### CSIRTの構築

## 出題まとめ
### 午後1
#### H30.春
1. ソフトウェアの脆弱性
2. 情報セキュリティ対策の強化
3. LAN分離
#### H29.秋

### 午後2
### H30.春
1. セキュリティ対策の評価
2. Webサイトのセキュリティ