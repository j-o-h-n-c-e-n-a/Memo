# 
## 1.デプロイ

### 1.1.a.可用性、スケーラビリティ、メンテナンス
#### EC2、AutoScaling
* ELB配下のWebサーバーをAutoScaling
    + 特徴
        - Webサーバーの負荷に応じてスケール
        - EC2は複数AZに分散し高可用性を担保
    + スケーリングトリガーの例
        - ELBのリクエスト数
        - アプリケーションサブグループ内EC2の平均CPU使用率
* SQSのジョブを処理するワーカーをAutoScaling
    + 特徴
        - ワーカーの負荷に応じてスケール
        - EC2は複数AZに分散し高可用性を担保
        - スポットインスタンスがマッチするケースが多い
    + スケーリングトリガーの例
        - キュー内のメッセージ数
* ECSホストのAutoScaling
    + 特徴
        - ECSクラスタ内のホストを負荷に応じてスケール
        - ホストへのタスクの配置・管理はECSが実施
    + スケーリングトリガーの例
        - ECSホストのCPU使用率
        - ECSホストのメモリ使用率
#### ELB
* 環境でELB作成したあとはELBのタイプを変えることはできない。
* セキュリティグループの割り当て
* スティッキーセッション
* AutoScalingとの連携
* ECSのALB対応
    + ALBによりECSコンテナをまたがった負荷分散
* ACMとの統合
    + ACMを使用して、証明書のリクエストと管理を容易に実施
    + 無料で利用可能
    + ELBに対する証明書の設定を数クリックで完了
* Route 53 DNSフェイルオーバー対応
    + Route53のヘルスチェック機能とELBが連携
* OpsWorksのELB対応
    + OpsWorksでELBをレイヤーにアタッチして、負荷分散が可能
* AWS Trusted AdvisorによるELBのチェック
    + ELBのセキュリティとフォールトトレランスをチェック
#### S3、EBS
* CloudFrontとの連携
* CloudWatchによるメトリクス管理
* CloudTrailによるAPI管理
    + 操作ログを収集する
#### RDS

### 1.1.b.リリースプロセス
### 1.1.c.CI/CDパイプライン
### 1.1.d.デプロイパターン
#### In-Place
* 稼働中の環境を新しいアプリケーションで更新する。
* 直接アプリを配置して再起動
#### Linear
* トラフィックを毎回、同じ増分、同じ間隔で移行する
#### Blue/Green
* 特徴
    + アプリケーションのデプロイ時にASGを再作成
    + ELBまたはDNSで環境を切替
    + ASG作成にはCloudFormationを利用することで環境構築を自動化可能
#### Rolling
* サーバーをいくつかのグループに分けて、グループごとにIn-Placeする
* アプリケーションの古いバージョンでリクエストを処理するインスタンスもあり、新しいバージョンでリクエストを処理するインスタンスもある
#### Rolling with additional batch
* バッチサイズ分の新しいインスタンスを追加してデプロイを実行
* キャパシティーを100%に維持できる(メリット)
* 本番でよく使われる
#### Immuitable
* 同じ環境にASGだけ追加する、それで同じASGが同じDNS名を持つ
* Blue/GreenはDNS名が変わるがこの方法は変わらない
* リリース後は旧環境を削除
* 部分的に完了したローリングデプロイにより発生する問題を防ぐ
* 古いバージョンと新しいバージョンが混在している時間はある
#### All at once
* 全てのサーバで同時にIn-Place更新をする

### 1.2.Elastic Beanstalk
    使い慣れたサーバーでデプロイおよびスケーリングするためのサービス
* エラー発生したとき、管理者にメール通知したい場合、SNSと連携。
* AWSの各リソースを管理するために、サービスロールと呼ばれるIAMロールが必要
#### CloudFormation
    スタックというAWSリソースの集合体を自動構築
* 開発環境、本番環境を選択できるようにしたい場合、ParametersとConditionsセクションを使う
* 複数のリージョンで独自のAMIを使用したEC２インスタンスを含むアーキテクチャを起動したい場合、Mappingsセクションを使う
* 別の AWS CloudFormation スタックのリソース出力を参照する場合、Outputsセクションを使う
#### AWS SAM
    CloudFormationの拡張機能で、サーバーレスアプリケーションの開発とデプロイを素早く開始できる
#### OpsWorks

### 1.3.デプロイサービス
#### Codeシリーズ
##### CodeCommit
    プライベートなGitリポ
* AWS SNS、Lambda、CloudWatch Event Rulesを使用して通知が可能。
* SSH or HTTPSを使って安全に接続できる
* SSH / HTTPSで使用する認証情報はIAMユーザー毎に生成
* クロスアカウントアクセス有
##### CodeBuild
    ソースコードをコンパイルし、ユニットテストを実行して、すぐにデプロイできるArtifactsを生成
* buildspec.yml
* フックの順序
    1. アプリケーションストップ
    2. バンドルをダウンロード
    3. beforeInstall
    4. afterInstall
    5. アプリケーションスタート
    6. サービスの検証
* CodeBuildコンテナは実行終了時に削除される
* Dockerイメージは、プライベートレジストリからのものも使用できる
* CloudTrailを有効化することでAWS CodeBuildのログを取得できる
* CloudWatchによるモニタリング可能
##### CodeDeploy
    ソフトウェアのデプロイを自動化するフルマネージド型のサービス
* appspec.yml
* EC2、Lambda, オンプレミス、コンテナへの自動的なデプロイメント
* エラーを検知すると、自動的にロールバック
    + 新しいデプロイIDを使用
##### CodePipeline
    迅速かつ信頼性の高いアプリケーション更新を実現
* SNSと連携することで、パイプラインのステージに対して承認アクションを追加することができる
##### CodeStar
    迅速にプロジェクトを開始できるサービス
##### CodeArtifact
    ソフトウェアパッケージを保存して配信できるサービス
* 一般的に使用されるパッケージマネージャ及びビルドツールと連携して動作
#### CodeGuru
* CodeGuru Profiler:アプリケーションのパフォーマンスを可視化
* CodeGuru Reviewer:自動レビュー

### 1.4.サーバーレスアーキテクチャ
#### 代表的なサーバーレスサービス
#### 一般的なサーバーレスアーキテクチャ

## 2.セキュリティ
### 責任共有モデル
### ネットワークセキュリティ
#### VPC

### 認証と認可
#### IAM
#### Cognito
* ユーザープール
* IDプール

### データおよびアプリケーションのセキュリティ、暗号化
#### ACM
    独自ドメインのアプリケーションでの証明書の管理、設定の機能
#### KMS
    暗号化するためのキーを作成、管理できる
#### HSM
    保管時の暗号化
### 確認
    CloudWatch、CloudTrail
#### API Gateway
    イベントとして API Gateway のすべての API コールをキャプチャ
* リクエストの IP アドレス、リクエスタ、時間を含める
* イベント履歴を確認
* 証跡を作成して S3 バケットにイベントを送信
* API とそのバックエンドサービスにおけるレイテンシーを分析
* 特定のリクエストに着目したサンプリングルールを設定
* サービスマップは個々の地域のデータではなく全ての地域のデータが表示される
* 署名バージョン4を使用してリクエストに署名する
### IAM,STSおよびIdentityFederation
* IAM：明示的に拒否するポリシーがある場合、他の許可されたステートメントを上書きする

## 3.開発
### グローバルインフラストラクチャー
#### AWSリージョン
#### アベイラビリティーゾーン
#### エッジロケーション
##### CloudFront

### 開発環境
#### AWS API
#### SDK
    認証情報を参照する順番   
1. 環境変数
2. java system properties
3. デフォルトのcredential profileファイル
4. コンテナのcredentials
5. EC2のInstance profile credentials
#### Toolkit
#### AWS Cloud9

### ストレージ
#### Amazon Elastic Block StoreとAmazon Elastic File System
#### Amazon Simple Storage Service（S3）
### データベース
#### Amazon RDS、Amazon Aurora
#### Amazon ElastiCache
#### Amazon DynamoDB
    NoSQL。トランザクションが不要で結果整合性が担保されていればよいデータが対象
* 読み込みキャパシティユニット（結果整合性なら最大4KBで2回/s）
* グローバルセカンダリインデックスでは一貫性のある読み取りをサポートしていない
* 一貫性のある読み取りをDAXクラスターにリクエストした場合、結果はキャッシュされない
* DynamoDBストリームとLambdaトリガーの併用はベストプラクティス
* プロジェクション式

### コンピューティング、API
#### Lambda
* タイムアウトは最大15分
* 環境変数は最大4KB
* 関数をスケジューリングするベストプラクティスはCloudWatch Iventを使用すること
* エイリアス機能
#### API Gateway
* Cognito設定
    + IDプール
    + ユーザープール
* エンドポイント
    + エッジ最適化
    + リージョン
    + プライベート
* オプションキャッシュ
    + API キャッシュの TTL 値はデフォルトで 300 秒
    + ステージ毎に設定
    + キャッシュを検証する 2 つの方法
        - CloudWatch メトリクス: CacheHitCount と CacheMissCount
        - タイムスタンプを作成し、API レスポンスに含める
* スロットリング制限
* リソースポリシー

### メッセージング、ステート制御、イベント
#### SQS
* メッセージ保持期間（デフォルト4日間）
* 自動的にメッセージを取得して、ターゲットの Lambda 関数にルーティングします
* Lambda 関数が正常に完了すると、メッセージを削除します
* 通信データの暗号化、CloudTrailに記録
* FIFO キュー（1回）
* デッドレターキュー：使用すると、処理できないメッセージを後で分析するために分離できます
* 可視性タイムアウト：Amazon SQS で、他の消費コンポーネントがメッセージの受信と処理を行わないようにする期間
#### SNS、SES
#### MQ
* オンプレミスからAWSへのブリッジ
* サードパーティクラウドとのコネクタ
#### Kinesis Streams 
#### StepFunctions
#### EventBridge
    イベント駆動

### コンテナ
* ECS Task PlacementはECS with EC2のみ使用可能
    + 3つのタイプ
        1. Binpack - 使用するインスタンスの数を最小にしようとする most cost effective
        2. Ramdom - タスクをランダムに配置する
        3. Spread - インスタンスIDやAZに基づいてタスクを分散配置する
    + 2つの制約
        1. distinctInstance - それぞれのタスクは異なるコンテナインスタンスに配置する
        2. memberOf - クラスタークエリ言語を使用して制約を定義可能     example:t2のインスタンスにのみタスクを配置する

## 4.リファクタリング
    ベストプラクティスへの理解を深めること
### DVA の原則(ベストプラクティス)
* スケールアップよりもスケールアウト
* アクセスキーより IAM ロールが望ましい
* アンマネージドサービスよりもマネージド
* リソースや API を直接公開する事は避け、AWS エッジサービスや API ゲートウェイを使用する
* サーバーにセッション状態を保存していては優れたアーキテクチャにはならない
* インフラストラクチャを疎結合化する
* サーバーレス化する
* トラブルシューティング時には、セキュリティグループや NACL を常に確認する
* VPC のプライベートサブネット内に作成されたインスタンスは、NAT を使用しない限りインターネットと通信することが出来ない
* インターネットと通信するには、インターネットゲートウェイとルートテーブルのルートが必要
* EBS ボリュームは、EC2 インスタンスに疎結合されている。
    + ブートボリュームの場合を除いて、アタッチまたはデタッチできる
### スケーラビリティを確保する
### 環境を自動化する
### 使い捨て可能にする
### 疎結合にする
### サーバーではなくサービスを設計する
### 適切なデータベースを選択する
### 単一障害点をなくす
### コストを最適化する
### キャッシュを使用する
### すべてのレイヤーでセキュリティを実装する
### 増え続けるデータを処理する

### 移行
#### 6つのR
    Re-HostとRe-platform
1. Retain
    + 今は変更を加えず、将来再検討する
2. Re-host
    + リフト、シフトする
3. Refactor
    + 再設計
4. Re-platform
    + リフト、変更、シフトする
5. Replace
    + 既にクラウドに存在するソリューションを購入する
6. Retire
    + アプリケーションやシステムが価値を提供しているかどうかを評価する
#### 実施に向けて

## 5.モニタリングとトラブルシューティング
    ベストプラクティスへの理解を深めること
### モニタリング
#### CloudWatch
* 基本的なモニタリングにアラームを設定する場合 - 少なくとも5分
* 詳細なモニタリングにアラームを設定する場合 - 少なくとも1分
* CloudWatch Logs

#### VPCフローログ
* CloudWatch Logsへの発行する場合は、IAMロールが必要

#### X-Ray
* SQSと統合されている場合、リソースヘッダーはSQSのメッセージサイズ等に影響しない
* サンプリングルールのデフォルト - 1秒あたりに1つのリクエスト、ホスト毎の追加の5%の要求がリクエストされる
* X-Ray SDKが提供するもの 
    + インターセプター コードに追加して受信 【HTTP リクエストをトレース】する
    + クライアントハンドラー アプリケーションが他の AWS サービスの呼び出しに使用する AWS SDK クライアントを計測する
    + An HTTP クライアント 別の内部および外部 HTTP ウェブサービス呼び出しを計測する
* EC2・ECS・Lambda・ElasticBeanstalkなどど連携可能
* セグメント：動作に関するデータ（リソース名、リクエスト詳細など）
* サブセグメント：呼び出しに関する追加の詳細な情報（AWSサービス、データベースなど）

#### CloudTrail
* CloudTrailはログをS3バケットに保存

### トラブルシューティング
#### スロットリングエラー
* リクエスト拒否や遅延が発生する原因にスロットリングエラー
* これはサービスAPIの制限リクエスト回数に達したために発生
#### エクスポネンシャルバックオフ
* スロットリングエラーや5XXサーバー側のエラーが発生した際には、アプリケーションからの再試行が必要
#### セキュリティのトラブルシューティング
* AWSサービスに対してのリクエストが拒否される原因は、IAMポリシーで許可されていないか、拒否されているかのいずれか

## 0. ベストプラクティス


## 参考
https://docs.aws.amazon.com/whitepapers/latest/practicing-continuous-integration-continuous-delivery/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/whitepapers/latest/change-management-in-the-cloud/change-management-in-the-cloud.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/wellarchitected/latest/serverless-applications-lens/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/whitepapers/latest/s3-optimizing-performance-best-practices/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/wellarchitected/latest/management-and-governance-lens/management-and-governance-lens.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/wellarchitected/latest/saas-lens/saas-lens.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/whitepapers/latest/practicing-continuous-integration-continuous-delivery/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/wellarchitected/latest/cost-optimization-pillar/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/wellarchitected/latest/performance-efficiency-pillar/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/wellarchitected/latest/security-pillar/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/whitepapers/latest/real-time-communication-on-aws/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/whitepapers/latest/microservices-on-aws/microservices-on-aws.html
https://docs.aws.amazon.com/whitepapers/latest/tagging-best-practices/tagging-best-practices.html
https://docs.aws.amazon.com/whitepapers/latest/kms-best-practices/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/whitepapers/latest/blue-green-deployments/welcome.html?did=wp_card&trk=wp_card
https://docs.aws.amazon.com/wellarchitected/latest/serverless-applications-lens/welcome.html?did=wp_card&trk=wp_card


## サンプル問題
### Q. ある企業のアプリケーション開発チームは、Java アプリケーションを開発し、ソースコードを .war ファイルに保存しました。AWSリソース上でアプリケーションを実行したいと考えており、実行される基礎となるリソースのプロビジョニングと管理を処理できるサービスを探しています。ソリューションアーキテクトは、開発者がJavaソースコードファイルをアップロードするためにどのAWSサービスを使用することを推奨すべきですか？
1. AWS Elastic Beanstalk
2. AWS OpsWorks
3. AWS CodeDeploy
4. AWS CloudFormation
<details><div>
    答え：１
</div><div>
    AWS Elastic Beanstalkは、AWSクラウドにアプリケーションを迅速にデプロイし、管理するために使用することができます。開発者はアプリケーションをアップロードし、Elastic Beanstalkは容量のプロビジョニング、ロードバランシング、自動スケーリング、アプリケーションのモニタリングなどを処理します。
</div></details>

### Q. RDS MYSQLデータベースから定期的にデータを集計して、自動的にレポートを生成するタスクを実装する必要があります。毎回同一のクエリ処理でデータ集計を行うことができ、Lamdba関数を用いて実装することを検討しています。この要件を満たすことが出来るLamdba関数の実装方法を選択してください。
1. LambdaをRDSに連携して、データ処理を実施する関数を作成する。
2. RDSプロキシを利用し、データベースに流れるトラフィックを処理する。
3. RDSのスティッキーセッションを有効化する。
4. Lambda関数をSQSによるポーリング処理と連携してRDSへのデータ処理を行う。
<details><div>
    答え：２
</div><div>
    RDS プロキシはアプリケーションとRDSデータベースの間の仲介役として機能します。RDS プロキシは、必要となるデータベースへのコネクションプールを確立および管理し、アプリケーションからのデータベース接続を少なく抑える機能です。RDS プロキシは、Lambda関数からデータベースに直接流れるすべてのデータベーストラフィックを処理します。
</div></details>

### Q1. ある企業が、カスタムAMI上のテキストファイルにアクセスキー(アクセスキーIDおよびシークレットアクセスキー)を格納しようとしています。その企業は、アクセスキーを使用して、AMIから作成されたインスタンスからDynamoDBテーブルにアクセスします。セキュリティチームは、よりセキュアなソリューションを要求しています。セキュリティチームの要求に応えるソリューションはどれですか。
1. アクセスキーをAmazonS3バケットに格納し、起動時にインスタンスからアクセスキーを取得する。
2. インスタンスユーザーデータを介してアクセスキーをインスタンスに渡す。
3. プライベートサブネット内で起動されたキーサーバーからアクセスキーを取得する
4. そのテーブルにアクセスする権限を持つIAMロールを作成し、そのロールを使用してすべてのインスタンスを起動する
<details><div>
    答え：4
</div></details> 

### Q23. ある部品製造企業が、製造拠点から部品データファイルをアップロードし、そのファイルから部品の属性情報を抽出してデータベースに登録しようと計画しています。アップロードするファイルのサイズは1GBあり、属性情報の抽出には数秒の処理時間がかかると想定されます。製造拠点からファイルがアップロードされる頻度は予測できません。何時間もアップロードが発生しないこともあれば、複数のファイルが同時にアップロードされることもあります。最も費用効率の良い方法でこのワークロードを処理できるアーキテクチャはどれですか
1. Kinesis Data Streams を使用してファイルを格納し、Lambdaを使用して処理する。
2. EC2インスタンス上にWebアプリケーションを開発し、アップロードされたファイルの属性情報を抽出して、RDSに格納する
3. 製造拠点のサーバーからEFSにNFSマウントしてファイルを格納する。格納されたファイルにEC2インスタンスからアクセスして処理する
4. ファイルをS3に格納し、S3イベント通信を使用してLambda関数を呼び出し、ファイルを処理する
<details><div>
    答え：４
</div><div>ファイルのアップロードのイベントをトリガーとして短い時間で処理を行うには、Lambda関数の利用が適しています。S3にファイルをアップロードすることでアップロードイベントによってLambda関数を起動し、属性情報の抽出及びデータベースの格納処理を行えます。1．のKinesis Data Streamsは、大量のストリーミングデータを収集するサービスですが、容量の大きいファイルのアップロードには向いていません。2．の場合、ファイルのアップロード頻度が予測できないことから、EC2インスタンスを使った実装はコスト効率が悪くなることがあります。Cの場合、ファイルがアップロードされているかをEC2インスタンスが常時EFSにポーリングする仕組みが必要となり、非効率です。
</div></details>

### Q24. ある自治体でWEB投票システムの構築を計画しています。投票は年に数回程度ですが、投票日には大量のリクエストが予想されます。最も費用効率の良いWeb投票システムのアーキテクチャはどれですか
1. CloudFrontを利用してリクエストを受信する。オリジンサーバーをS3の静的ウェブホスティングで構成し、投票情報をS3に格納する。
2. WebサーバーをリザーブインスタンスのEC2インスタンスで構成する。EC2インスタンスで受信したリクエストを背後のDynamoDBに投票情報として格納する
3. API Gateway を構成してリクエストを受信する。API Gateway からLambda関数を起動し、背後のDynamoDBに投票情報を格納する
4. S3の静的ウェブホスティングを構成し、リクエストを受信する。投票情報をS3に格納する
<details><div>
    答え：３
</div><div>この設問は、年に数回しか稼働しないシステムで、かつ稼働するときは大量のトラフィックが予想されるWebシステムという要件です。リクエストが来ないときにできるだけコストがかからず、動的な拡張性を持つシステム構成にします。3．のLambda関数の場合、プログラムの顔づ出の従量課金となるので要件に適しており、投票日の大量のトラフィックにも動的にスケールアウト・スケールインすることで対応できます。2．の場合、システムを利用していない期間もEC2インスタンスやEBSの課金があり、コスト効率が悪くなります。1.4．の場合、データを格納するストレージとしてS3を利用しているため、大量のトラフィックに対応する応答性の要件に適していません。
</div></details>

### Q45. 定期的にLambda関数を実行する場合、利用するAWSサービスはどれですか
1. SNS
2. SQS
3. CloudWatch Events
4. CloudWatch アラーム
<details><div>
    答え：３
</div><div>CloudWatch Events では定期実行するイベントを作成でき、実行するアクションとしてLambda関数を指定できます。
</div></details>

### Q51. Amazon SNSでサポートしている通知エンドポイントやクライアントはどれですか
1. Email
2. CloudFrontディストリビューション
3. FTP
4. Lambda
5. SNMP
<details><div>
    答え：１，４
</div><div>SNSはHTTPS、Email、SMS、モバイルプッシュ、Lambda、SQSに通知を送ることができます。SNSから２３５に対して通知を直接送ることはできません
</div></details>

### Q77. EC2インスタンスで実行しているアプリケーションからDynamoDBへのデータの書き込みを許可する設定について、より安全な方法はどれですか。
1. EC2インスタンスのアクセスキーを使用してDynamoDBにアクセスする
2. IAMユーザーのアクセスキーを使用してDynamoDBにアクセスする
3. DynamoDBへのアクセスを許可したIAMロールをEC2インスタンスに設定し、一時的セキュリティ認証情報を使用してDynamoDBにアクセスする
4. DynamoDBのVPCエンドポイントを使用して暗号化通信を実施する
<details><div>
    答え：３
</div><div>１は不適切な選択肢です。インスタンスのアクセスキーといった場合、EC2インスタンスのプログラムで利用されるアクセスキーとなりますが、EC2インスタンスからアクセスキーが漏洩するリスクもあります。そのため、アクセスキーの厳重な管理やローテーションが必要となります。
  ２は不適切な選択肢です。1と同様、アクセスキーの厳重な管理やローテーションが必要となります。
  3は適切な選択肢です。EC2からDynamoDBへのアクセスでは、IAMユーザーのアクセスキーではなく、EC2に設定したIAMロールによる一時的セキュリティ認証情報を利用することで、アクセスキーの厳重な管理やローテーションが不要となり、より安全なアクセスを実現できます。
  ４は不適切な選択肢です。VPCエンドポイントを使用したDynamoDBへのアクセスにより、アクセス経路を安全にはできますが、DynamoDBのアクセス権を制御することはできません。
</div></details>

### Q88. スマートフォンから写真画像をアップロードし、その画像を縮小するアプリケーションを設計しています。アップロードする画像は数KB～数百KB程度のサイズであり、縮小処理は数秒で完了しますが、頻度は一定でなく集中してアップロードされるときもあれば数日間全くされないときもあります。この場合、最もコスト効率の高いソリューションはどれですか
1. スマートフォンから画像ファイルをS3にアップロードし、S3イベント通信を使用してLambda関数を呼び出し、画像ファイルの縮小処理をする
2. EC2インスタンス上にWebアプリケーションを開発し、アップロードされた画像ファイルを縮小処理して、S3に格納する
3. Kinesis Data Streamsを使用して画像ファイルを格納し、Lambdaを使用して縮小処理する
4. S3静的ウェブホスティングを構成し、アップロードされた画像ファイルを縮小処理して、S3に格納する
<details><div>
    答え：１
</div><div>
  １は適切な選択肢です。S3にファイルをアップロードするイベントをトリガーとして短時間の処理を行うにはLambda関数が適しています。
  ２は不適切な選択肢です。頻度が一定でない動的な処理のためEC2インスタンスによる構成よりもプログラムの稼働量に課金されるLambdaが適しています。
  ３は不適切な選択肢です。ファイルの保存先としては、Kinesis Data Streams よりも低コストで永続的に保存できるS3のほうが優れています。
  ４は最適な選択肢ではありません。静的ウェブホスティングを用いてアップロードサイトを用意するのはよいソリューションですが、縮小処理について具体的な記載がないため、１のほうがより適切といえます。
</div></details>

### Q89. ある企業でAWSを利用して大規模なシステムを運用しています。このシステムを監視し、エラーログが検出された場合に、メッセージを加工してシステム管理者のモバイル端末に通知する仕組みの構築を計画しています。このソリューションを最も効率的に構成できるのはどれですか
1. CloudWatch Alarmでエラー文字列をフィルタし、Lambda関数を実行するように構成する。Lambda関数でログメッセージを加工し、SNSを利用してシステム担当者にプッシュ通知を行うように構成する。
2. CloudWatch Logsでエラー文字列をフィルタし、Lambda関数を実行するように構成する。Lambda関数でログメッセージを加工し、SNSを使用してシステム担当者にプッシュ通知を行うように構成する。
3. CloudWatch Alarm でエラー文字列をフィルタし、メッセージを加工する処理を構成する。CloudWatch Alarmで、SNSを実行するアクションを王精してシステム担当者にプッシュ通知を行うように構成する。
4. CloudWatch Logsでエラー文字列をフィルタし、EC2インスタンスを実行するように構成する。EC2インスタンスでログメッセージを加工し、SNSを利用してシステム担当者にプッシュ通知を行うように構成する。
<details><div>
    答え：２
</div><div>
  １は不適切な選択肢です。CloudWatch AlarmはCloudWatchの通知機能であり、収集されたログをフィルタする機能はありません。
  ２は適切な選択肢です。ログメッセージを検出して加工する場合には、CloudWatchLogsからLambda関数を実行し、Lambda関数からSNSを利用してプッシュ通知します。
  ３は不適切な選択肢です。１と同様の理由です。
  ４は不適切な選択肢です。メッセージを加工する処理は、EC2よりものほうがコスト面と開発面で効率的に構成できます。
</div></details>

### Q90. あるチケット販売サイトでオンラインチケット販売システムの構築を計画しています。チケット販売は月に数回程度しか起こりませんが、販売当日には大量のリクエストが予想されます。最も費用対効果の高いオンラインチケット販売システムのアーキテクチャはどれですか
1. S3の静的ウェブホスティングを構成し、リクエストを受信する。チケット販売情報をS3に格納する。
2. API Gatewayを構成し、リクエストを受信する。API GatewayからLambda関数を起動し、背後のDynamoDBにチケット販売情報を格納する。
3. WebサーバーをリザーブドインスタンスのEC2インスタンスで構成する。EC2インスタンスでリクエストを受信して背後のRDSにチケット販売情報を格納する。
4. ELBロードバランサーを構築し、AutoScalingでEC2インスタンスをクラスター構成し、Webサービスをインストールする。チケット販売情報を背後のDynamoDBに格納する
<details><div>
    答え：２
</div><div>
  １は不適切な選択肢です。S3にデータを格納するのは、大量のリクエストに対応できる応答性の要件に適していません。大量のリクエストが見込まれるサービスのデータベースは、S3以外のデータベースを選択します。
  ２は適切な選択肢です。月に数回しか稼働せず、稼働するときは大量のトラフィックが予想される動的なシステム構成が要件です。Lambda関数は、プログラムの稼働量での従量課金のため、この場合の要件に適しています。
  ３は不適切な選択肢です。EC2インスタンスによる構成は、継続的に課金されるためコスト効率が悪く、要件に適していません。リザーブドインスタンスを利用したとしても、Lambdaのほうが費用対効果が高いといえます。RDSの利用可否についてはアクセス数に依存するため、明確に判断できませんが、EC2を選択している時点でこの選択肢は除外します。
  ４は不適切な選択肢です。EC2インスタンスにクラスタ構成は、継続的に課金されるためコスト効率が悪く、要件に適していません。また、S3にデータを格納するのは、大量のリクエストに対応できる応答性の要件に適していません。大量のリクエストが見込まれるサービスのデータベースについては、S3以外のデータベースを選択します。
</div></details>

### Q123. あなたの会社はWebアプリケーションを運営しています。そのWebアプリケーションにはAutoScalingを設定しており、スケーリングによってインスタンスが削除される際にはユーザー情報を移動することが必要です。ユーザー情報を保存するのに適しているのはどれですか
1. ElasticCache
2. EBS
3. DynamoDB
4. S3
<details><div>
    答え：３
</div><div>
  １は不適切な選択肢です。ElasticCacheはアプリケーションが高速なI/Oを必要とする場合に利用するキャッシュサービスです
  ２は最適な選択肢ではありません。ユーザー情報は構造化もしくは半構造化召されているケースが多いため、EBSよりはデータベースのほうが後程活用しやすいといえます
  ３は適切な選択肢です。データによって属性数が異なっていても保存しやすい、NoSQLのキーバリュー型データベースであるDynamoDBが適しています。また、DynamoDBは書き込みと同時に複数のAZに複製されるため、耐障害性にも優れています。一般的にDynamoDBはWebのセッション情報、ストレージのインデックスなどのメタデータ、ユーザーIDをはじめとするユーザーデータの保存に適しています。
  ４は最適な選択肢ではありません。２と同じ理由に加え、I/Oが高くなる可能性を考えるとS3よりもDynamoDBのほうが適しています。
</div></details>

### Q. ある組織が、AWSクラウドにデータを移行しています。オンプレミスアプリケーションは、ネットワークファイルシステムを共有しており、コードを変更せずにデータにアクセスする必要があります。データは重要情報であり、かつ頻繁にアクセスされます。ソリューションアーキテクトは、可用性と耐久性を最大化するために、どのストレージソリューションを推奨すべきですか？
1. Amazon S3
2. Amazon EFS
3. AWS Storage Gateway – ファイルゲートウェイ
4. Amazon EBS
<details><div>
    答え：3
</div></details>

### Q. あるソリューションアーキテクトが、Amazon API Gatewayを使用してAPIをデプロイし、複数の利用者向けにAPIキーを作成しました。ある特定の利用者からのリクエストが多く、ソリューションアーキテクトはリクエストの割合を制限する必要があります。他の利用者が影響を受けないようにするためには、ソリューションアーキテクトはどのように対処すればよいでしょうか？
1. クライアントごとのスロットル制限を設定する
2. メソッドごとのスロットル制限を構成する
3. アカウントレベルのスロットル制限を設定する
4. サーバー側のスロットル制限を設定する
<details><div>
    答え：１
</div><div>
</div></details>

### Q. ある企業が、Amazon API Gatewayを使用してAPIを導入しました。特定のエンドポイントに多くのリクエストが集中しているため、ソリューションアーキテクトはリクエストレイテンシーとAmazon EC2エンドポイントへの呼び出し回数を減らすための対策を実施するよう依頼されました。どのようにすれば最も簡単に実現できるでしょうか？
1. CloudFrontでエッジに最適化されたエンドポイントを構成する。
2. メソッドにキャッシュを作成し、TTLを設定する。
3. プライベートエンドポイントを構成し、ElastiCacheを前面に配置する。
4. ステージのキャッシュを作成し、TTLを設定する。
<details><div>
    答え：４
</div></details>

### Q. あるEコマース会社では、非常に人気のあるWebアプリケーションがあり、大量のトラフィックを受けています。このアプリケーションは、利用者のプロファイルデータとショッピングカート情報をデータベースに格納する必要があります。ソリューションアーキテクトは、1秒間に数百万リクエストのピーク負荷とミリ秒の応答時間をサポートするデータベースソリューションを設計する必要があります。運用上のオーバーヘッドを最小限に抑え、スケーリングによるダウンタイムを発生させないようにしなければなりません。ソリューションアーキテクトはどのデータベースソリューションを推奨すべきですか？
1. Amazon RDS
2. Amazon DynamoDB
3. Amazon Athena
4. Amazon Aurora
<details><div>
    答え：２
</div></details>

### Q. あなたは、DynamoDBの使用するか検討しています。次のうち、DynamoDBに関するAWSのベストプラクティスはどれですか。(2つ選択してください)
1. 各アイテムに個別のローカルセカンダリインデックスを使用する
2. 400KB以上のオブジェクトはS3に格納し、DynamoDBではポインタを使用する
3. アクセス頻度の高いデータとそうでないデータを別々のテーブルに格納する
4. BLOBデータのユースケースに使用する
5. 大きなファイルを使用する
<details><div>
    答え：２，３
</div></details>

### Q. WebサーバをEC2、DBサーバをAmazon RDSを利用したWebサービスを構築しようとしており、データベース全体の負荷を軽減したい。この場合に有効な施策は次のうちどれですか？
1. リードレプリカを利用し、ELBを利用する
2. データベースの前にElastiCacheを設置し、リードレプリカを利用する
3. データベースの前にElastiCacheを設置し、マルチAZ構成にする
4. リードレプリカを利用する
<details><div>
    答え：２
</div></details>

### Q. オンプレミスのWebアプリケーションのデータベースをAWSに移行しています。データベースに対するクエリは複数のCPUやスレッドを必要とするもので、このデータベースのパフォーマンスを向上させるためにマルチスレッドのインメモリキャッシングを使用しています。データベースキャッシュの代替として最も適切なサービスはどれですか？
1. Amazon ElastiCache Memcached
2. Amazon ElastiCache Redis
3. Amazon DynamoDB DAX
4. Amazon RDS MySQL
<details><div>
    答え：１
</div></details>

### Q. Amazon ElastiCache for Redisクラスタは、複数のアベイラビリティーゾーンにまたがって動作しています。ソリューションアーキテクトは、ノード間で複製される機密データのセキュリティについて懸念しています。どのようにソリューションアーキテクトは機密データを保護することができますか？
1. 転送中の暗号化を有効にする
2. at-rest encryptionを有効にする
3. Redis AUTHコマンドを発行する
4. MFAとAPIログの設定
<details><div>
    答え：１
</div><div>
    Amazon ElastiCacheの転送中の暗号化は、データをある場所から別の場所に転送する際のセキュリティを向上させることができるオプションの機能です。
</div></details>

### Q. ベンチャー企業がAWS上で新規アプリの開発を行っています。高パフォーマンスとマルチスレッド対応が可能なことがシステムの要件になっています。データベース層のセッション処理に利用するアーキテクチャを選択してください。
1. S3
2. DynamoDB
3. ElastiCache Redis
4. ElastiCache Memcached
<details><div>
    答え：４
</div></details>

### Q. あなたはエンジニアとして、API Gatewayによって起動されるAWS Lambda関数の開発に取り組んでおり、API Gatewayプロキシ統合を構成しました。しかしながら、開発したLambda関数はAPIから呼び出されると、エラー（502 Bad Gateway）が発生しました。この問題の最も可能性の高い根本原因はどれでしょうか？
1. Lambdaプロキシ統合バックエンドから互換性のない出力が返答されているため。
2. API GatewayのプロキシのAPI名が無効となっているため。
3. IAMロールの設定でLambda関数へアクセス権限が適切で無いため
4. エンドポイントのリクエストのタイムアウト
<details><div>
    答え：1
</div></details>

### Q. あなたはAmazon DynamoDBを使用してシステムの予約受付を管理しており、テーブルは予約受付日に基づいてパーティションを分割しています。広告プロモーションの効果により特定の受け付け日に予約が大量に入ったことで、プロビジョニングされたスループットが大幅に不足し、DynamoDBへの書き込みが抑制されました。この問題をAWSのベストプラクティスに従って最小のコストで解決できるものを選択してください。
1. 予約受付日ごとの新しいDynamoDBテーブルを作成
2. パーティションキーの値に乱数を追加します。
3. 読み取りテーブルおよび書き込みキャパシティーユニットの追加
4. DynamoDBテーブルへのグローバルセカンダリインデックス追加
<details><div>
    答え：2
</div></details>

### Q. Elastic Beanstalkを使用してアプリケーションをデプロイしました。クライアントからのリクエストを処理するためには複数のインスタンスが必要です。デプロイ所要時間は考慮せず、アプリケーションのログを保持するために既存のインスタンスを使用する必要があります。これらの要件を満たすデプロイ方法を選択してください。
1. rolling deployment with an additional batch (追加バッチによるローリングデプロイ)
2. ローリング
3. 変更不可
4. All at once
<details><div>
    答え：2
</div></details>

### Q. ある会社では、開発環境を全てDocker形式で展開できるようにAmazon ECSを使用してDockerアプリケーションを構築しています。CloudFormationを使用して、AutoScalingグループを設定したECSクラスターを展開しています。ECSクラスターはクラスターAとクラスターBの2つのクラスターで構成されています。まずはクラスターAのパラメーター入力を使用してCloudFormaitonテンプレートによってEC2インスタンスを起動しました。次にクラスターBのパラメーター入力を使用してCloudFormationテンプレートを起動したところ、全インスタンスがクラスターBではなくクラスターAとして起動されてしまいました。この問題の可能性が高い根本的な原因を説明してください。
1. セカンドクラスターに接続するには、Dockerイメージを再設定する必要があった、ということを見落としたのが原因。
2. EC2インスタンスにセカンドクラスターに配置するためのIAMアクセス許可が設定されていないことが原因。
3. ブートストラップ中にクラスター名パラメーターがファイル/etc/ecs/ecs.configに反映されていないことが原因。
4. EC2インスタンスのセキュリティグループが間違ったECSクラスターを指していることが原因。
<details><div>
    答え：3
</div></details>

### Q. ある会社はDynamoDBを利用したシステム開発を行っています。今回1日のうち特定の時間に15秒間だけアプリケーションのエラーが発生しています。エラーを調査したところ、ProvisionedThroughputExceededExceptionというエラーレスポンスが返ってきていることが分かりました。このエラーの対応方法として、適切な方法を選択肢から選んでください
1. 即時再試行をプログラムする方法
2. 再試行する前に待機時間をプログラムする方法
3. ProvisionedThroughputを増加させる方法
4. エクスポネンシャルバックオフで再試行するようにプログラムする方法
<details><div>
    答え：4
</div><div>
    今回のポイントはエクスポネンシャルバックオフです。これは指数関数的後退つまり指数関数的に処理のリトライ間隔を後退させるアルゴリズムのことです。
これは高可用性を実現するために、システムが停止した際に指数関数的にリトライを実行するという意味です。
</div></details>

### Q. 
1. 
2. 
3. 
4. 
<details><div>
    答え：
</div></details>

### Q. 
1. 
2. 
3. 
4. 
<details><div>
    答え：
</div></details>

### Q. 
1. 
2. 
3. 
4. 
<details><div>
    答え：
</div></details>

### Q. 
1. 
2. 
3. 
4. 
<details><div>
    答え：
</div></details>

