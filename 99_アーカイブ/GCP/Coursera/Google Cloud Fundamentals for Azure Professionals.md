# コース紹介
こんにちは、AzureプロフェッショナルのためのGoogle Cloud基礎トレーニングコースへようこそ。このコースの目的は、既存のAzureの知識を活用し、Google Cloudの概要を知っていただくことです。Google Cloudの提供するサービスは、大きく分けて、コンピュート、ストレージ、ビッグデータ、機械学習、Web、モバイル分析、バックエンドソリューションのアプリケーションサービスに分類されます。ビデオ、クイズ、ハンズオンラボを組み合わせて、Google Cloudの価値と、クラウドソリューションがどのようにビジネス戦略に影響を与えるかを学びます。本コースの対象者は、Google Cloud上にアプリケーションを展開し、アプリケーション環境を構築する予定のソリューション開発者、システム運用担当者、ソリューションアーキテクトを想定しています。また、このコースはGoogle Cloudを評価するビジネス意思決定者にとっても有益なものとなるでしょう。このコースでは、Google Cloudに特化したサービスやコンセプトについて学んでいきますが、基礎レベルのコースであるため、クラウド技術を全く知らない学習者を対象とした内容もあることを念頭に置いておいてください。このコースに前提条件はありませんが、アプリケーション開発、Linux OS、システム運用、データ分析、機械学習などに精通していると、カバーする技術を最もよく理解することができます。達成したい学習目標は5つあります。このコースを終了するまでに、Google Cloudの製品とサービスの目的と価値を確認し、Appエンジン、Google Kubernetesエンジン、ComputeエンジンなどのGoogle Cloud上のエンドユーズアプリケーションデプロイメント環境を選択し、Cloud Storage、Cloud SQL、Cloud Bigtable、FirestoreなどのGoogle Cloud Storageオプションを選択して使用し、Google Cloud Servicesと対話し、顧客がGoogle Cloudを使ってきた方法を説明できるようになることです。それでは、始めましょう。

# クラウドコンピューティングの概要
まずは冒頭で、クラウドコンピューティングの概要について説明します。最近話題のクラウドですが、そもそもクラウドとは何なのでしょうか？クラウドコンピューティングという言葉は、アメリカの国立標準技術研究所が作ったもので、アメリカ特有のものはないのですが。クラウドコンピューティングとは、以下の5つの特徴を持つ、IT技術の利用方法である。まず、顧客はオンデマンドでセルフサービス可能なコンピューティングリソースを手に入れることができます。ウェブインターフェースを介して、ユーザーは人間の介入を必要とせずに、必要な処理能力、ストレージ、ネットワークを手に入れることができます。第二に、顧客はインターネットを通じて、接続できる場所であればどこからでもこれらのリソースにアクセスできる。第三に、クラウドプロバイダーはこれらのリソースの大きなプールを持っており、その中からユーザーにリソースを割り当てます。これにより、プロバイダーはリソースを大量に購入し、そのコストを顧客に転嫁することができます。顧客は、リソースの正確な物理的位置を知る必要も、気にする必要もない。第四に、リソースは弾力的であることです。より多くのリソースが必要な場合は、より多くのリソースを迅速に入手することができます。必要なリソースが少ない場合は、規模を縮小することができます。最後に、お客様は使用した分だけの支払い、または使用した分だけの予約をします。リソースの使用を停止すれば、支払いも停止されます。以上です。これがクラウドの定義です。しかし、なぜ今、クラウドモデルがこれほどまでに魅力的なのでしょうか。その理由を理解するためには、少し歴史を振り返る必要があります。クラウドコンピューティングへの流れは、コロケーションと呼ばれる最初の波から始まりました。コロケーションは、物理的なスペースを借りるという経済的な効率をユーザーに提供しました。データセンターの不動産に投資する代わりに。今日の仮想化データセンターは第二の波であり、数十年前のプライベートデータセンターやコロケーション施設と類似しています。仮想データセンターの構成要素は、サーバー、CPU、ディスク、ロードバランスなど、ホステッドコンピューティングの物理的な構成要素と一致していますが、現在は仮想デバイスになっています。仮想化によって、企業はインフラを維持しながらも、ユーザーが管理し、ユーザーが設定する環境を維持することができます。数年前、Googleは、仮想化モデルの制約の中でビジネスを十分に速く進めることができないことに気づきました。そこでGoogleは、自動化されたサービスとスケーラブルなデータの組み合わせで構成される、完全に自動化された弾力的なサードウェーブ・クラウドであるコンテナベースのアーキテクチャに切り替えたのです。サービスは、アプリケーションの実行に使用されるインフラを自動的にプロビジョニングし、設定します。今日、Google Cloudは、Googleの顧客がサードウェーブクラウドを利用できるようにしている。Googleは、将来、規模や業種に関係なく、すべての企業がテクノロジーによって競合他社と差別化されると考えています。そのテクノロジーは、ますますソフトウェアの形になっていくでしょう。優れたソフトウェアは、高品質のデータに基づいています。つまり、すべての企業がデータカンパニーであり、いずれはデータカンパニーになるのです。

# IaaS and PaaS
データセンターの仮想化により、お客様には2つの新しいタイプのサービスが提供されるようになりました。一般にIaaSと呼ばれるInfrastructure as a Serviceと、PaaSと呼ばれるPlatform as a Serviceです。IaaS は、生の計算、ストレージ、およびネットワーク機能を、物理データセンターと同様のリソースに仮想的に編成して提供するものです。これに対し、PaaSは、アプリケーションに必要なインフラへのアクセスを提供するライブラリにコードをバインドします。これにより、より多くのリソースをアプリケーションロジックに集中させることができます。IaaSモデルでは、顧客は事前に割り当てたリソースに対して支払いを行います。PaaSモデルでは、顧客は実際に使用するリソースに対して支払いを行います。クラウドコンピューティングの進化に伴い、マネージドインフラストラクチャーとマネージドサービスに勢いが移っています。マネージド・リソースとサービスを活用することで、企業はビジネス目標により集中することができ、技術インフラの構築と維持に費やす時間と費用を削減することができます。また、顧客に対してより迅速かつ信頼性の高い製品やサービスを提供することができます。サーバーレスは、クラウドコンピューティングの進化における新たなステップです。サーバーレスでは、インフラ管理が不要になるため、開発者はサーバーの設定よりもコードに集中することができます。Googleが提供するサーバーレス技術には、イベント駆動型のコードを従量制サービスとして管理するCloud Functionsや、コンテナ化したマイクロサービスベースのアプリケーションを完全管理環境でデプロイできるCloud Runがあります。このコースの範囲外ですが、Software as a Service（SaaS）について聞いたことがあり、それが何であり、クラウドの生態系にどのように適合するのか不思議に思ったことがあるかもしれません。SaaSとは、Software as a Serviceの略で、ローカルコンピュータにはインストールされず、クラウド上で動作するアプリケーションのことです。その代わり、クラウド上でサービスとして実行され、エンドユーザーがインターネット上で直接利用することになる。Googleワークスペースの一部であるGmail、Docs、Driveなどの人気のあるGoogleアプリケーションは、すべてSaaSの一例である。

# Google CloudとAzureのリージョンとゾーンの比較
GoogleとAzureは共に、顧客にクラウドサービスを提供する方法としてリージョンを使用しています。Googleはデータセンターサービスを提供するためにゾーンを使用する。各リージョンには少なくとも3つのゾーンがある。Azureは、高可用性を提供する方法として、アベイラビリティゾーンと呼ばれるデータセンターのクラスターを使用する。すべてのリージョンには、少なくとも3つのアベイラビリティゾーンがある。Google CloudとAzureはともに、世界中のさらに多くの場所にPoP（Point of Presence）を持っています。これらのPoPは、エンドユーザーの近くでコンテンツをキャッシュするのに役立つ。Google CloudはPoPを利用してCloud CDNを提供し、App EngineやCloud Storageなどのサービスにビルトインのエッジキャッシングを提供しています。Azureは、4つの製品でコンテンツ配信ネットワーク（CDN）サービスを提供するためにポイント・オブ・プレゼンスを使用しています。MicrosoftのAzure CDN Standard、AkamaiのAzure CDN Standard、VerizonのAzure CDN Standard、そしてVerizonのAzure CDN Premiumです。Google Cloudの接続拠点は、Googleが所有するファイバーを通じてデータセンターに接続されています。この障害物のない接続は、Google CloudベースのアプリケーションがGoogle Cloud上のすべてのサービスに高速で信頼性の高いアクセスが可能であることを意味します。リージョンとゾーンに関連する用語をまとめると、Google CloudとAzureの両製品は、互いに比較的近接したデータセンターとサービスのクラスターを定義するためにリージョンという用語を使用している。データセンターのサービスの可用性は、Google Cloudではゾーンに抽象化することができ、これはAzureのアベイラビリティゾーンと同等である。ただし、Azureのすべてのリージョンでアベイラビリティゾーンが利用できるわけではない。Google CloudとAzureはどちらもPoPを利用して、複数のサービスに対してビルトインのエッジキャッシュを提供する。

# The Google Cloud network
Google Cloudは、Google独自のグローバルネットワーク上で動作しています。Googleのネットワークは、この種のものとしては最大です。そして、Googleはその構築のために何年もかけて何十億ドルも投資してきました。このネットワークは、世界中にある100以上のコンテンツ・キャッシング・ノードを活用し、お客様のアプリケーションに最高のスループットと最小のレイテンシーを提供するよう設計されています。これらのノードでは、需要の高いコンテンツがキャッシュされ、より迅速にアクセスできるようになり、アプリケーションは最も迅速な応答時間を提供する場所からユーザーのリクエストに応答できるようになります。Google Cloudのインフラは、5つの主要な地域に拠点を置いています。北米、南米、ヨーロッパ、アジア、そしてオーストラリアだ。アプリケーションの設置場所の選択は、可用性、耐久性、レイテンシーなどの品質に影響を与えるため、複数の拠点を持つことは重要です。後者は、情報のパケットが送信元から送信先まで移動するのにかかる時間を測定するものです。これらのロケーションはそれぞれ、いくつかの異なるリージョンとゾーンに分割されます。地域は独立した地理的な領域を表し、ゾーンで構成されています。例えば、ロンドンやeurope-west2は、現在3つの異なるゾーンで構成されるリージョンです。ゾーンは、Google Coudのリソースが配置されるエリアです。例えば、コンピュートエンジンを使って仮想マシンを起動した場合、リソースの冗長性を確保するために指定したゾーンで実行されます。また、異なる地域でリソースを実行することも可能です。これは、世界中のユーザーにアプリケーションを近づけるため、また自然災害など地域全体で問題が発生した場合の保護のために有効である。Google Cloudのサービスの中には、マルチリージョンと呼ばれる方法でリソースを配置することをサポートしているものがある。例えば、Cloud Storageでは、データをヨーロッパのマルチリージョンに配置することができます。これは、ロンドンとベルギーのように、ヨーロッパ内で160km以上離れた少なくとも2つの地理的な場所に冗長的に保存されることを意味する。Google Cloudは現在29のリージョンで88のゾーンをサポートしているが、この数は常に増え続けている。最新の数字は cloud.google.com/about/locations で確認することができます。

# 環境負荷
Google Cloudのネットワークを含む仮想世界は、物理的なインフラの上に成り立っています。そして、サーバーが並ぶラックには、膨大なエネルギーが使われています。既存のデータセンターを合わせると、世界の電力のおよそ2％を消費しています。このことを念頭に置き、Googleはデータセンターを可能な限り効率的に稼働させるよう取り組んでいます。お客様と同じように、Googleも地球のために正しいことをしようとしています。Google Cloudをご利用のお客様には、それぞれ環境に関する目標があることを理解しています。そして、Google Cloud上で作業着を稼働させることは、その目標を達成するための一部となり得ます。そのため、GoogleのデータセンターがISO 14001認証を最初に取得したことは有益なことです。ISO14001は、資源効率の向上と廃棄物の削減を通じて、組織が環境パフォーマンスを向上させるための枠組みを示した規格です。

その一例として、フィンランドのハミナにあるグーグルのデータセンターをご紹介します。この施設は、Googleのデータセンターの中で最も先進的で効率的な施設のひとつです。フィンランド湾の海水を利用した冷却システムは、エネルギー使用量を削減し、この種のものとしては世界で初めてです。

創業の10年間で、Googleはカーボンニュートラルを実現した最初の大企業となりました。2030年までに再生可能エネルギー100％を達成した最初の企業です。完全にカーボンフリーな運営を行う最初の主要企業となることを目指します。

# セキュリティ
Googleの9つのサービスにはそれぞれ10億人以上のユーザーがおり、Googleの社員は常にセキュリティに気を配っていることがお分かりいただけるでしょう。Googleがお客様のデータの安全を守るためにどのような取り組みを行っているか、いくつかご紹介しましょう。セキュリティインフラは、データセンターの物理的なセキュリティから始まり、ハードウエアとソフトウエアのセキュリティへと段階的に説明することができます。続いて、インフラの基盤となるハードウェアとソフトウェアがどのように保護されているかを説明し、最後に、運用上のセキュリティをサポートするための技術的制約とプロセスについて説明します。まず、ハードウェア・インフラストラクチャー層ですが、これは3つの重要なセキュリティ機能で構成されています。Googleのデータセンターにあるサーバーボードとネットワーク機器は、いずれもGoogleがカスタム設計したものです。また、Googleは、現在サーバと周辺機器の両方に配備されているハードウェアセキュリティチップを含むカスタムチップを設計しています。Google のサーバーマシンは、バイオ、ブートローダに対する暗号署名など、正しいソフトウェアスタックを起動するためのさまざまな技術を使用しています。大佐とベースのオペレーティングシステムイメージこの層の最終的な機能は、敷地のセキュリティですGoogleは、物理的なセキュリティ保護の複数の層を組み込んだ独自のデータセンターを設計し、構築しています。これらのデータセンターへのアクセスは、ごく少数のGoogleの社員のみに制限されています。Googleはさらに、一部のサーバーをサードパーティのデータセンターでホスティングしています。このデータセンターでは、データセンター事業者が提供するセキュリティ層の上に、Googleが管理する物理的なセキュリティ対策が施されていることを保証しています。次に、サービスデプロイメント層ですが、ここではサービス間通信の暗号化が重要な特徴となっています。Googleのインフラは、ネットワーク上のリモートプロシージャコールRPCデータに対して、暗号によるプライバシーと整合性を提供します。GoogleのサービスはRPCコールを使って相互に通信し、インフラは自動的にすべてのインフラを暗号化する。データセンター間のRPCトラフィック Googleは、このデフォルトの暗号化をすべてのインフラに拡張できるハードウェア暗号アクセラレータの配備を開始しました。Googleデータセンター内のRPCトラフィック 次に、ユーザーIDレイヤーのGoogle Central Identityサービスがあります。通常、エンドユーザーはGoogleのログインページで単純なユーザー名とパスワードの入力を求められるだけでなく、このサービスによって明示されます。このサービスは、過去に同じデバイスや類似の場所からログインしたことがあるかなどのリスク要因に基づいて、ユーザーに追加情報の提供を求めるインテリジェントな機能も備えています。また、ユーザーはサインイン時に、ストレージサービス層でユニバーサルセカンドファクターU two Fオープンスタンダードに基づくデバイスなどのセカンダリーファクターを採用することもできます。我々は、物理ストレージ、言い換えれば、ストレージサービスを介して間接的にファイルストレージにアクセスするほとんどのアプリケーションで、暗号化アットレストセキュリティ機能を見つけることができます。これらのストレージサービスのレイヤーでは、一元管理されたキーを使用した暗号化が適用されます。また、GoogleはハードディスクやSSDのハードウェア暗号化のサポートも可能にしています。次のレイヤーはインターネット通信レイヤーで、これはインターネット上で提供されているGoogleのサービスの2つのセキュリティ機能で構成されています。Googleフロントエンドと呼ばれるインフラサービスに自分自身を登録し、すべてのTLS接続が公開秘密鍵ペアを使用して終了することを保証します。そして、認証局C AからのX 0.509証明書だけでなく、完全な前方秘匿をサポートするなどのベストプラクティスに従います。G F Eはさらに、サービス拒否攻撃に対する保護も適用し、サービス拒否のDDOS保護が提供されています。そのインフラの規模の大きさにより、Googleは多くのDDOS攻撃を単純に吸収することができます。また、Googleは多層マルチレイヤーのDDOS防御を備えており、G F Eの背後で稼働するサービスに影響が及ぶリスクをさらに軽減します。最後の層はGoogleの運用セキュリティ層で、まず侵入検知ルールと機械知能という4つの重要な機能を提供します。Googleの運用セキュリティチーム、インシデントの可能性の警告を与える Googleは、その検出と応答機構の有効性を測定し、改善するためにレッドチームの演習を実施しています。次に、リスク内部の削減です。Googleは積極的にインフラストラクチャへの管理アクセスを許可されている従業員の活動を制限し、積極的に監視します。次に、Googleの従業員に対するフィッシング攻撃から守るために拒否する従業員のあなたがあります 従業員のアカウントは、U 2 F互換性のあるセキュリティキーの使用を必要とします。最後に、厳格なソフトウェア開発慣行があります。Googleの従業員は、中央のソース管理、新しいコードの二者間レビューを必要とします。また、Googleは、開発者が特定のクラスのセキュリティバグを持ち込まないようにするためのライブラリも提供しています。さらに、Google は脆弱性報奨プログラムを実施しており、Google のインフラストラクチャやアプリケーションのバグを発見して知らせてくれた人には、報酬を支払っています。Google の技術基盤、セキュリティについては、cloud dot google dot com forward slash security forward slash security design で詳しく説明されています。

# オープンソースのエコシステム
一部の企業は、特定のベンダーに縛られることを恐れて、ワークロードをクラウドに移行することを躊躇しています。しかし、何らかの理由でGoogleが自分たちのニーズに最適なプロバイダーでなくなったとお客様が判断した場合、アプリケーションを別の場所で実行する能力を提供することができるのです。Googleは、技術の重要な要素をオープンソースライセンスで公開し、顧客にGoogle以外の選択肢を提供するエコシステムを構築しています。例えば、Google社内で開発された機械学習のためのオープンソースソフトウェアライブラリであるTensorFlowは、強力なオープンソースのエコシステムの中心となっています。Googleは相互運用性を提供します。それは複数のレイヤーのスタックです。KubernetesとGoogle Kubernetes Engineは、顧客が異なるクラウド間で動作するマイクロサービスを混在させる能力を提供します。Google Cloudのオペレーション・スイートは、複数のクラウドプロバイダーにわたってワークロードを監視することができる。

# Pricing and billing
このセクションの締めくくりとして、Google Cloudの料金体系を簡単に見てみましょう。Googleは、主要なクラウドプロバイダーとして初めて、Infrastructure as a Service ComputeのCompute EngineにPer-second課金を提供しました。さらに、コンテナインフラであるGoogle Kubernetesエンジン、ビッグデータシステムHadoopに相当するがサービスとして稼働するDataproc、柔軟な環境のVMであるApp Engineのユーザーに対してもPersecond課金を提供するようになった。サービスとしてのプラットフォームです。これらの製品・サービスについては、コースの後半でご紹介します。Compute Engineでは、課金月のかなりの期間、仮想マシンインスタンスを稼働させると自動的に割引が適用される持続使用割引を提供しています。具体的には、1ヶ月のうち25%以上インスタンスを実行すると、そのインスタンスで使用する分単位で、Compute Engineが自動的に割引を適用します。カスタム仮想マシンタイプにより、Compute Engineの仮想マシンをアプリケーションに最適なVCPUとメモリの量で微調整できるため、ワークロードに合わせて価格を調整することができます。オンラインの価格計算ツールは、お客様のコストの見積りに役立ちます。cloud.google.com/products/calculatorで試してみてください。さて、Google Cloud の請求が高額にならないようにするには、どうしたらよいかとお考えでしょう。Googleは、そのためのツールをいくつか提供しています。予算は、課金アカウント・レベルまたはプロジェクト・レベルで定義することができます。予算は、固定された限度額とすることも、他の指標に関連付けることもできる。例えば、前月の支出額に対するパーセンテージを設定し、コストが予算の上限に近づいたときに通知されるようにすることができます。例えば、予算の上限を20,000ドル、そしてアラートを90%に設定すると、費用が18,000ドルに達したときに通知アラートを受け取ることができます。アラートは一般的に50％、90％、100％で設定されますが、カスタマイズすることも可能です。レポートは、Google Cloudコンソールのビジュアルツールで、プロジェクトやサービスに基づいて支出を監視することができる。最後に、Google Cloudは、エラーや悪意ある攻撃によるリソースの過剰消費を防止するためのクォータも実装している。アカウントの所有者とGoogle Cloudコミュニティ全体の双方を保護する。クォータには、レートクォータとアロケーションクォータの2種類があります。どちらもプロジェクトレベルで適用される。レートクォータは特定の時間が経過するとリセットされる。例えば、デフォルトでは、GKE サービスは、各 Google Cloud プロジェクトから 100 秒ごとに API を 1,000 回呼び出すというクォータを実装している。この100秒を過ぎると、制限はリセットされる。割り当てクォータは、プロジェクトで持つことのできるリソースの数を管理する。例えば、デフォルトでは、各Google Cloudプロジェクトは、5つ以下の仮想プライベートクラウドネットワークを許可するクォータを持つ。プロジェクトはすべて同じクォータで開始されるが、Google Cloud のサポートに増加のリクエストをすることで、いくつかのクォータを変更することができる。

# 3
# Google Cloudのリソース階層
このセクションでは、Google Cloudの機能構造について見ていきます。Google Cloudのリソース階層には4つのレベルがあり、下から順にリソース、プロジェクト、フォルダー、組織ノードとなります。最初のレベルはリソースである。これは仮想マシン、Cloud Storageバケット、テーブル、BigQuery、その他Google Cloudにあるあらゆるものを表している。リソースはプロジェクトに整理され、第二階層に位置する。プロジェクトはフォルダやサブフォルダに整理することができ、これらは3番目のレベルに位置する。そしてトップレベルには組織ノードがあり、組織内のすべてのプロジェクト、フォルダー、リソースを包含する。このリソース階層を理解することは、Google Cloud を使用する際にポリシーがどのように管理され適用されるかに直接関係するため、重要である。ポリシーは、プロジェクト、フォルダ、および組織ノードの各レベルで定義することができる。Google Cloudのサービスの中には、ポリシーを個々のリソースに適用できるものもある。ポリシーは下方に継承される。つまり、あるフォルダにポリシーを適用すると、そのフォルダ内のすべてのプロジェクトにも適用される。リソース階層の2番目のレベルであるプロジェクトについて、もう少し詳しく見てみましょう。プロジェクトは、APIの管理、課金の有効化、共同作業者の追加と削除、その他のGoogleサービスの有効化など、Google Cloud Servicesを有効化して使用するための基礎となるものである。各プロジェクトは、組織ノードの下にある独立したエンティティであり、各リソースは正確に1つのプロジェクトに属している。プロジェクトは別々に構築、管理されるため、異なるオーナーやユーザーを持つことができる。各Google Cloudプロジェクトは、プロジェクトID、プロジェクト名、プロジェクト番号の3つの識別属性を持っている。プロジェクトIDはGoogleによって割り当てられたグローバルにユニークな識別子で、作成後に変更することはできない。いわゆるイミュータブル（immutable）である。プロジェクトIDは、Google Cloudに作業する正確なプロジェクトを通知するために、さまざまな文脈で使用される。しかし、プロジェクト名はユーザーが作成するものである。プロジェクト名はユニークである必要はなく、いつでも変更可能であるため、不変ではありません。また、Google Cloudは各プロジェクトに一意のプロジェクト番号を割り当てている。これらのGoogleが生成した番号が存在することを知っておくことは役に立ちますが、このコースではあまり調べません。これらは主にGoogle Cloudがリソースを追跡するために内部的に使用されています。Google CloudのResource Managerツールは、プロジェクト管理をプログラム的に支援するために設計されています。これはAPIで、アカウントに関連するすべてのプロジェクトのリストを収集し、新しいプロジェクトを作成し、既存のプロジェクトを更新し、プロジェクトを削除することができます。以前に削除されたプロジェクトを復元することも可能で、RPC APIとREST APIでアクセスすることができる。Google Cloudのリソース階層の第3階層はフォルダーである。フォルダでは、選択した粒度のリソースにポリシーを割り当てることができる。フォルダー内のリソースは、そのフォルダーに割り当てられたポリシーとパーミッションを継承する。フォルダは、プロジェクト、他のフォルダ、またはその両方の組み合わせを含むことができます。フォルダを使用すると、階層構造で組織の下にプロジェクトをグループ化できます。たとえば、組織には複数の部門があり、それぞれが独自の Google Cloud リソースのセットを持っている場合があります。フォルダを使用すると、部門ごとにこれらのリソースをグループ化することができます。フォルダはまた、チームが独立して作業できるように管理者権限を委譲する機能を提供します。例えば、同じチームが管理する2つの異なるプロジェクトがある場合、ポリシーを共通のフォルダに入れることで、同じパーミッションを持たせることができます。しかし、この方法では、両方のプロジェクトにポリシーの複製を置くことになり、面倒でエラーが発生しやすくなります。両方のリソースの権限を変更する必要がある場合、1か所だけでなく、2か所で変更する必要があります。フォルダを使用するには、Google Cloudの階層構造で最上位のリソースである組織ノードを持つ必要がある。そのアカウントに付属する他のすべては、フォルダ、プロジェクト、および他のリソースを含む、このノードの下に行く。この最上位の組織ノードには、いくつかの特別なルールが関連付けられています。たとえば、組織ポリシー管理者を指定して、適切な権限を持つ人だけがポリシーを変更できるようにすることができます。また、プロジェクト作成者の役割を割り当てることができます。これは、誰がプロジェクトを作成することができ、したがって、誰がお金を使うことができるかを制御するのに最適な方法です。新しい組織ノードの作成方法は、あなたの会社がGoogleワークスペースの顧客でもあるかどうかによって異なります。ワークスペース・ドメインを持っている場合、Google Cloudプロジェクトは自動的に組織ノードに所属することになる。そうでない場合は、Google のアイデンティティ、アクセス、アプリケーション、およびエンドポイント管理プラットフォームである Cloud identity を使用して、組織ノードを作成することができます。一度作成された新しい組織ノードでは、ドメイン内の誰もが以前と同じようにプロジェクトや課金アカウントを作成することができます。また、このノードの下にフォルダーを作成することもできます。フォルダとプロジェクトの両方は、組織ノードの子とみなされます。

# Google CloudとAzureのリソース階層を比較する
先ほど見た Google Cloud のリソース階層を基に、より馴染みのある Microsoft Azure のレイアウトと比較することができます。一番下から始めて、どちらのプラットフォームもVMやストレージなどインフラストラクチャを構築するのに必要なコンポーネントを持っています。これらは、AzureプラットフォームとGoogle Cloudの両方でリソースと呼ばれます。その次のレベルはプロジェクト・レベルで、プロジェクトに関連するリソースを集めます。Google Cloudではこれらの要素をプロジェクトと呼んでいますが、リソース・グループという用語の方が馴染みがあるかもしれません。Google CloudのフォルダもAzureのサブスクリプションも、オーナーは各チームや部門から発生するコストを管理することができる。Google Cloudでは、プロジェクトレベルでの課金も可能です。最後に、トップレベルは、オーナーのサブスクリプションに対するコンプライアンスとポリシーの定義に役立ちます。これは、Google Cloudでは組織ノード、Azureでは管理グループと呼ばれている。Google Cloudのリソースの差別化のポイントは、複数の課金アカウント、またはプロジェクトごとにグループ化された課金である。Azureでは1つのアカウントに1つの課金アカウントが必要なのに対し、Google CloudではGoogle Cloudのアカウントごとに多くの課金アカウントを柔軟に持つことができる。Google Cloudはプロジェクト単位で課金をロールアップできるが、Azureはサブスクリプション単位で課金をロールアップする。Google Cloudでは、アカウント、組織、フォルダ、またはプロジェクトレベルでポリシーを適用することができる。Azureでは、管理グループ、サブスクリプション、リソースグループの各レベルでポリシーを適用することができます。アカウント管理者は、Google Cloudでは、Googleユーザーまたはグループにすることができます。Azureでは、アカウント管理者にグループとロールを持つActive DirectoryまたはADテナントを使用します。最後に、Google CloudアカウントはGmailユーザーまたはGoogle Workspaceスーパーユーザーを管理者として持つことができますが、Azureはアカウントを管理するために独自のルートユーザーを必要とします。

# Identity and Access Management (IAM)
組織ノードに多くのフォルダ、プロジェクト、リソースが含まれる場合、誰が何にアクセスできるかを制限する必要が生じることがあります。このタスクを支援するために、管理者はアイデンティティとアクセス管理（IAM）を使用することができます。IAMを使用すると、管理者は、誰がどのリソースで何ができるかを定義するポリシーを適用することができます。IAMポリシーの「誰が」の部分には、Googleアカウント、Googleグループ、サービスアカウント、またはCloud Identityドメインが使用できる。IAMポリシーの「何ができるか」の部分は、ロールによって定義される。IAMロールは、権限の集合体である。例えば、プロジェクトで仮想マシンインスタンスを管理するには、仮想マシンを作成、削除、開始、停止、および変更できる必要があります。これらの権限をロールにグループ化することで、理解しやすく、管理しやすくしています。ユーザー、グループ、またはサービスアカウントに、リソース階層の特定の要素に関するロールが与えられると、結果として、選択された要素と、階層内のその下のすべての要素の両方に、ポリシーが適用されます。IAMには3つのロール、基本、事前定義、およびカスタムがある。最初のロールタイプは基本です。基本ロールはかなり広い範囲をカバーする。Google Cloudプロジェクトに適用すると、そのプロジェクト内のすべてのリソースに影響を与える。基本ロールには、オーナー、エディター、ビューアー、ビリングアドミニストレータが含まれる。これらの基本的な役割についてもう少し詳しく見てみましょう。プロジェクト ビューアーはリソースにアクセスできますが、変更を加えることはできません。プロジェクトエディターは、リソースにアクセスして変更を加えることができます。また、プロジェクトオーナーもリソースにアクセスして変更を加えることができます。さらに、プロジェクトオーナーは、関連する役割と権限を管理し、課金を設定することができます。しばしば、企業は、誰かが私たちのプロジェクトの課金を制御したいが、プロジェクト内のリソースを変更することはできません。これは、課金管理者ロールによって可能になります。注意点 複数の人が機密データを含むプロジェクトで一緒に作業している場合、基本的な役割はおそらく広すぎます。幸いなことに、IAMは、典型的な職務上の役割のニーズを満たすために、より具体的に調整されたパーミッションを割り当てる他の方法を提供します。これが2つ目のタイプのロール、事前定義されたロールの話になる。Google Cloud Servicesでは、事前定義されたロールのセットを提供しており、それらのロールを適用できる場所まで定義している。例えば、仮想マシンをサービスとして提供するGoogle Cloudの製品であるCompute Engineを見てみよう。Compute Engineでは、特定のプロジェクト、フォルダ、または組織全体のCompute Engineリソースに、インスタンス管理者などの特定の定義済みロールを適用することができる。これにより、これらのロールを持つ人は、定義されたアクションの特定のセットを実行することができます。しかし、より具体的な権限を持つロールを割り当てる必要がある場合はどうしたらよいでしょうか。そのような場合は、カスタムロールを使用します。多くの企業では、組織内の各人に、業務を遂行するために必要な最小限の権限を与える最小権限モデルが採用されています。たとえば、インスタンスオペレータのロールを定義して、一部のユーザにコンピュートエンジンの仮想マシンの停止と起動は許可するが、再構成は許可しないようにすることが考えられます。カスタムロールを使用すると、これらの権限を正確に定義することができます。カスタムロールの作成を開始する前に、2つの重要な点に注意してください。まず、作成したカスタムロールを定義する権限を管理する必要があります。このため、組織によっては、定義済みのロールを使用する方が良いと判断する場合もあります。第二に、カスタムロールは、プロジェクトレベルまたは組織レベルのいずれかにのみ適用することができます。これらは、フォルダレベルに適用することはできません。

# Service accounts
もし、個人ではなく、コンピュートエンジンの仮想マシンに権限を与えたい場合はどうすればいいでしょうか？そのためのサービスアカウントです。

例えば、クラウドストレージにデータを保存する必要があるアプリケーションが仮想マシン上で動作しているとします。しかし、インターネット上の誰もがそのデータにアクセスできるようにする必要はありません。その特定の仮想マシンだけで、その仮想マシンをクラウドストレージに認証するためのサービスアカウントを作成することができます。

サービスアカウントはメールアドレスで命名されるが、パスワードの代わりに暗号鍵を用いてリソースにアクセスする。そのため、あるサービスアカウントにコンピュートエンジンのインスタンス管理者の役割が与えられている場合、そのサービスアカウントを持つVMで動作するアプリケーションは、他のVMSを作成、変更、削除することができるようになります。

サービスアカウントは管理される必要があります。例えば、アリスはどのグーグルアカウントがサービスアカウントとして機能するかを管理する必要があり、一方ボブはサービスアカウントのリストを見ることができればいいのです。幸いなことに、IDであることに加えて、サービスアカウントはリソースでもあるので、それ自身の鉄のポリシーを添付することができます。

これは、アリスがサーフェスアカウントのエディターロールを持ち、ボブがビューアーロールを持つことができることを意味します。これは他のグーグルクラウドリソースに対する役割の付与と同じです。

# Azure Active DirectoryとGoogle Cloudを比較する
Google Cloudでユーザー認証とパーミッションを確保するための主なメカニズムは、Identity and Access Management、またはIAMである。もしあなたがAzureのバックグラウンドを持っているなら、Active Directoryを使う方が馴染みがあるだろう。この2つのアプローチの違いを見てみよう。Google CloudとAzureでは、アクセス管理の方法が異なります。Googleでは、サービス間の認証を制御するためにサービスアカウントを使用します。一方、Azureでは、ロールベースのアクセス制御を使用して、Azureリソースにアクセスできる人、そのリソースで何ができるか、どの領域にアクセスできるかを制御する。Google Cloudでは、ユーザーIDはGoogle Cloudの外部で管理される。例えば、ワークスペースやGmailアカウントを使ってアイデンティティを管理することができる。Azureの場合、ユーザーIDはActive Directoryのテナントで管理するのが一般的だ。オンプレミスのActive DirectoryやAzure Active Directoryベースのソリューションがすでに組織内にある場合は、良い知らせがある。Google Cloudは、GoogleのIDアカウントを追加で作成することなく、ユーザーの統合アクセス管理を行うことができる。これにより、既存のActive DirectoryのテナントやDNSドメインを維持したまま、プロジェクトをGoogle Cloudに移行することができる。Google CloudはWindowsアプリケーション用のActive Directory版IAMもサポートしており、既存の組織構造を利用することができる。Google Cloudの場合、ポリシーは適用されたロールによってユーザーのパーミッションを設定するバインディングのリストである。Azureでは、ポリシーはメンバーのリストをロールにバインドするためにも使用される。Google Cloudでは、リソース上のユーザーロールペアリングがユーザーの権限を決定する。Azureでは、ロールベースのアクセス制御がロールの許可を決定する。ユーザーは特定のロールに割り当てられる。Googleでは、仕事の役割に合うように作られた定義済みのロールを使用します。Azureでは、ロール定義を使用します。ロール定義は、実行可能な操作をリストアップします。ロールには、高レベルのものと特定のものがあります。

# Cloud Identity
Google Cloudの新規顧客がプラットフォームの利用を開始するとき。GmailアカウントでGoogle Cloudコンソールにログインし、Googleグループを使って同じような役割のチームメイトと共同作業を行うのが一般的です。この方法は簡単に始められますが、チームのIDが一元管理されていないため、後で問題になることがあります。これは問題になりかねません。例えば、誰かが組織を離れた場合。この設定では、チームのクラウドリソースへのユーザーのアクセスを即座に削除する簡単な方法がないのです。

クラウドアイデンティティと呼ばれる宝石で。クラウドアイデンティティという宝物があり、組織はポリシーを定義し、ユーザーとグループを管理することができます。Google Admin Consoleを使えば、管理者は同じユーザー名とパスワードを使ってGoogle Cloudリソースにログインし、管理することができる。既存のアクティブ・ディレクトリやLDEPT Systemsを既に使用しているのだ。クラウドアイデンティティを使用することは、誰かが組織を離れるときにも意味がある。管理者はGoogle Admin Consoleを使用して、そのアカウントを無効化し、グループから削除することができる。

Cloud Identityには、無料版と、モバイルデバイスを管理する機能を備えたプレミアム版がある。

Google Cloudのお客様で、Google Workspaceのお客様でもある場合。この機能は、Google Admin Council ですでに利用可能です。

# Google Cloudとの連動
Google Cloud にアクセスし、対話する方法は 4 つあります。Cloud Console、Cloud SDKとCloud Shell、API、そしてCloud Console Mobile Appです。では、それぞれを探ってみましょう。Google Cloud Consoleは、Google Cloudのグラフィカル・ユーザー・インターフェース（GUI）で、シンプルなウェブベースのインターフェースでデプロイ、スケール、プロダクション問題の診断ができる。Cloud Consoleでは、リソースの検索、健全性の確認、リソースの完全な管理、リソースの使用量を制御するための予算設定などを簡単に行うことができる。また、Cloud Consoleは、リソースを素早く見つけるための検索機能や、ブラウザでSSH経由でインスタンスに接続する機能も備えています。2つ目は、Cloud SDKとCloud Shellを利用したものです。Cloud SDKは、Google Cloud上でホストされているリソースやアプリケーションを管理するために使用できるツールのセットである。これには、Google Cloudの製品やサービスのメインコマンドラインインターフェースを提供するG Cloudツール、コマンドラインからクラウドストレージにアクセスできるgsutil、BigQuery用のbqコマンドラインツールなどが含まれる。インストールすると、Cloud SDK内のすべてのツールはbinディレクトリの下に配置されます。Cloud Shellは、ブラウザから直接クラウドのリソースにコマンドラインでアクセスすることができます。Cloud ShellはDebianベースの仮想マシンで、5GBのホームディレクトリがあり、Google Cloudのプロジェクトやリソースを簡単に管理することができる。Cloud Shellを使えば、Cloud SDK、GCloudコマンド、その他のユーティリティが常にインストールされ、最新の状態で利用でき、完全に認証される。Google Cloudにアクセスする3つ目の方法は、アプリケーション・プログラミング・インターフェース（API）を利用する方法である。Google Cloudを構成するサービスは、APIを提供しており、あなたが書いたコードでそれらを制御することができる。Cloud Consoleには、Google APIs Explorerというツールがあり、どのAPIがどのバージョンで利用できるかが表示される。これらのAPIは、ユーザー認証が必要なものでも、対話的に試すことができます。あるAPIを探索し、それを使用するアプリケーションを構築する準備ができたとする。ゼロからコーディングする必要があるのだろうか？Google は Cloud Client Libraries と Google API クライアントライブラリ、および多くの一般的な言語を提供しており、あなたのコードから Google Cloud を呼び出すタスクから多くの労力を取り除いてくれる。現在、これらのライブラリに含まれている言語は、Java、Python、PHP、C-sharp、Go、Node.js、Ruby、C++である。そして最後に、Google Cloudにアクセスし対話する4つ目の方法は、Cloud Console Mobile Appを使うことだ。このアプリは、Compute Engineインスタンスの起動、停止、SSHによる接続、各インスタンスのログの確認に使うことができる。また、Cloud SQLインスタンスを停止したり、起動したりすることもできる。さらに、エラーの表示、デプロイのロールバック、トラフィックの変更、分割など、App Engineにデプロイされたアプリケーションの管理も可能です。Cloud Console Mobile アプリは、プロジェクトの最新の課金情報と、予算オーバーのプロジェクトに対する課金アラートを提供します。CPU使用率、ネットワーク使用率、1秒あたりのリクエスト数、サーバーエラーなど、主要な指標を示すカスタマイズ可能なグラフを設定することができます。モバイルアプリでは、アラートとインシデント管理も可能です。Cloud Console Mobile アプリは、cloud.google.com のフォワードスラッシュ console dash app からダウンロードすることができます。

# 仮想プライベートクラウドネットワーキング
このセクションでは、仮想ネットワーキングに焦点を当てながら、Google Compute Engineがどのように機能するかを探ります。多くのユーザーは、最初の Google Cloud プロジェクト内で独自の仮想プライベート クラウドを定義するか、デフォルトの仮想プライベート クラウドから始めることで Google Cloud を使い始めています。バーチャル・プライベート・クラウドとは何ですか？仮想プライベートクラウド（VPC）は、Google Cloudのようなパブリッククラウド内でホストされる安全な個々のプライベートクラウドコンピューティングモデルである。VPC上で、顧客はコードを実行し、データを保存し、ウェブサイトをホストし、その他通常のプライベートクラウドでできることは何でもできるが、このプライベートクラウドはパブリッククラウドプロバイダーによって遠隔地からホストされているのである。つまり、VPCはパブリッククラウドコンピューティングの拡張性と利便性と、プライベートクラウドコンピューティングのデータ分離を兼ね備えているのです。VPCネットワークは、Googleクラウドのリソースを相互に接続し、インターネットに接続する。これには、ネットワークのセグメント化、ファイアウォールルールによるインスタンスへのアクセス制限、特定の宛先にトラフィックを転送するための静的ルートの作成などが含まれる。ここで、多くの新しいGoogle Cloudユーザーを驚かせることがある。Google VPCのネットワークはグローバルである。また、サブネットを持つことができ、これは世界中のどのGoogle Cloudリージョンでも、より大きなネットワークのセグメント化された部分である。サブネットはリージョンを構成するゾーンにまたがることができる。このアーキテクチャにより、グローバルな範囲を持つネットワークレイアウトを簡単に定義することができる。リソースは同じサブネット上の異なるゾーンに存在することも可能である。サブネットに割り当てられたIPアドレスの範囲を拡張することで、サブネットのサイズを大きくすることができます。この場合、すでに設定されている仮想マシンには影響がありません。例えば、現在Google CloudのUS-East1リージョンに定義された1つのサブネットを持つ、1つのネットワークを持つVPCを例にとってみましょう。このVPCに2つのCompute Engine VMが接続されている場合、異なるゾーンにいても、同じサブネット上で隣り合っていることになる。この機能を利用することで、障害に強く、かつシンプルなネットワークレイアウトを維持したソリューションを構築することができる。

# 
# 
# 