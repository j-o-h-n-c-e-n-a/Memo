# Microsoft Power Platform Fundamentals

## Power Platform のビジネス価値を理解する
### Power Platform サービスのビジネス価値を説明する
    Office 365、Azure、Dynamics 365、およびスタンドアロンアプリケーションにまたがるローコード プラットフォーム
### Power Platform を使用してビジネスソリューションを拡張する
### Power Platform の管理とセキュリティについて説明する
### 管理センター
    Power Apps、Power Automate、Dynamics 365 の環境と設定を管理するための統合ポータル
* 環境の管理
    + ロール割り当て
    + AD連携
* 分析
    + 使用量、場所、、エラー、パフォーマンス、接続レポートなど
* リソースの管理
* データ統合
* データポリシー
### オンプレミスデータゲートウェイ
    社内ネットワーク内にあるデータソースに接続してアプリを作成するにはオンプレミスデータゲートウェイが必要

## Power Platform のコア コンポーネントを特定する
### Microsoft Dataverse について
    後述
* 以下の製品を使用する際は、Common Data Service が必要
    + Power Apps
    + Power Virtual Agents
    + AI Builder
### コネクタ について
    コネクタを通じてさまざまなサービスや外部データソースと接続できる
#### コネクタを使用したデータソースへの接続
    接続するデータソースの種類
* テーブル
    + 構造化された表形式のデータを取得しデータソース内のデータを更新する
    + ギャラリー、フォームなどのコントロールでテーブルのデータを読み取って表示する
    + 例：Common Data Service、SharePoint、SQL Server など
* アクション
    + 関数を使用してデータソースとやり取りする
    + メールの送信、画像の操作、アクセス許可の更新、カレンダーイベントの作成
    + 例：Office 365 Users、Twitter、Azure Blob Storage など
#### トリガーとアクション
    コネクタを設定した後に設定できる 2 種類の操作
* トリガー
    + Power Automate でのみ使用できる
    + トリガーの種類 
        - 自動化
        - インスタント
        - スケジュール
* アクション
    + Power Automate と Power Apps で使用できる
    + アクションの例 
        - Outlook にメールを送信する
        - データ ソースに新しい行を書き込む
#### Azure Cognitive Service Translator コネクタ
    Microsoft Translator を使用するとテキストを複数の言語に翻訳できる
* Power Apps
* Power Automate
#### カスタムコネクタ
    標準コネクタを使用できない場合、カスタム コネクタを作成することができる
* カスタム コネクタを作成するメリット
    + 一般に利用できる API や Azure などでホストしているカスタム API を呼び出しアプリを拡張できる
    + カスタム コネクタを作成すると PowerApps、Power Automate、Azure Logic Apps で使用できる
* カスタム コネクタを作成する 3 種類の方法
    + 空のカスタム コネクタ
    + OpenAPI 定義
    + Postman コレクション
* 一般公開できる
### AI Builder について
    ビジネスプロセスを最適化するように設計された AI モデルを提供する機能
* コーディングやデータサイエンスのスキルを必要とせず、カスタムまたは構築済みの AI モデルを使用できる
* AI Builder は Dataverse を使用する
#### Power Apps で AI Builder を使用する
    使用するモデルに応じた Power Apps コンポーネントが用意されている
* すぐに使用できる事前に構築された AI モデル
    + 名刺リーダー
    + テキスト認識エンジン
    + 領収書プロセッサ (プレビュー)
* ビルドとトレーニングを行うカスタム AI モデル
    + フォーム プロセッサ
    + 物体検出   
#### Power Automate で AI Builder を使用する
* すぐに使用できる事前に構築された AI モデル
    + 名刺リーダー モデル
    + カテゴリ分類モデル
    + エンティティ抽出モデル
    + キー フレーズ抽出モデル
    + 言語検出モデル
    + 感情分析モデル
    + テキスト認識モデル
    + テキスト翻訳モデル
* ビルドとトレーニングを行うカスタム AI モデル
    + カテゴリ分類モデル
    + エンティティ抽出モデル
    + フォーム処理モデル
    + 物体検出モデル
    + 予測モデル
#### AI Builder で独自のモデルを作成する
    ビジネスのニーズに合わせたカスタム AI モデルを作成する


## Power BI の機能を理解する
    データを分析するためにインサイトを提供するビジネス分析サービス
* さまざまなデータに接続しビジネス全体の統合ビューを取得する
* Web 上およびモバイル デバイス間で簡単に利用できる
* ダッシュボードやレポートを作成する
### Power BI コンポーネントを特定する
    データを検出、分析、視覚化し、チームメンバーとの洞察の共有や協同作業を支援する
* Power BI の主要ツール
    + Power BI Desktop
        - ローカル コンピューターにインストールして利用する Windows アプリケーション
        - レポート作成ツール
        - さまざまなデータ ソースに接続できる
    + Power BI サービス
        - Web ブラウザで利用するクラウドベースのオンラインサービス
        - レポートの管理やダッシュボード作成を行う Web サイト
        - Power BI サービスでもデータ ソースに接続できるが モデリングに制限あり
    + Power BI サービス：ダッシュボード
        - Power BI レポートの情報を集め 一目で見ることができる単一のページ
    + Power BI モバイルアプリ
### Power BI を使用して基本的なダッシュボードを構築する
    レポートからビジュアルをピン留めしてダッシュボードを作成する
* タイルを選択するとその視覚エフェクトが作成されたレポートページに移動する
### セキュリティと管理
    ユーザーと管理者の両方が安心して簡単に利用できる
* セキュリティ
    + Power BI は Azure 上に構築されており他の Microsoft サービスと同じセキュリティレベルを保つ
    + ユーザーは Azure Active Directory に保持されている資格情報を使用してログインする
    + ユーザーごとにさまざまなアクセス制御が可能
* Power BI 管理ポータル
    + ガバナンス ポリシーの構成
    + 使用状況の監視
    + ライセンス、容量などを含む Power BI テナント管理
### データに接続して使用する
    Power BI Desktop はさまざまなデータ ソースに接続できる
* Power BI 固有のコネクタが 110 個以上存在する
* CSV、テキスト、Web サイトの URL から表形式のデータを直接抽出することもできる
### Power Query エディター
    データの整形と変換に役立つ Power Query エディター ツール
### データの視覚化
    Power BI レポートに追加できるさまざまな種類の視覚化 (ビジュアル)
### ビジュアルデータの エクスポートとテーブル表示
    ビジュアルに使用するデータを表示する方法
### データのフィルター
    レポートをフィルタリングして強調表示する
* フィルタリングはレポートのみ適用可能
* フィルターでビジュアルが変更してもデータソースが変更されることはない
* スライサー
    + 複数のグラフに対するフィルター機能
### 機能
#### レポート：ページの複製
    既存のページを再利用したい場合は [ページの複製] をおこなう
#### 共有
    Power BI サービスでデータセット、ダッシュボード、レポートを同僚と共有できる
* ユーザーやチームメンバーがレポートやダッシュボードに変更を加えても基のデータは影響を受けない
* チームメンバーと共有できない場合は自分と同僚のライセンスを確認する
#### ワークスペース
    Power BI のダッシュボード、レポート、データセットの格納場所
* マイワークスペース
    + 自分のコンテンツを操作するための個人用ワークスペース
    + 自分だけがアクセスできる
    + ダッシュボードとレポートはマイ ワークスペースから共有できる
* ワークスペース
    + チームメンバーと共同作業を行うことができるワークスペース
    + 基本的に Power BI Pro ライセンスが必要
#### セキュリティで保護されたポータルや Web サイトにレポートを埋め込む
    埋め込みオプションを使うと安全に内部 Web ポータルにレポートを埋め込むことができる
#### アプリの発行
    ダッシュボード、レポート、データセットなどの関連するコンテンツを “アプリ” として安全に発行する
* ワークスペース内で作成できる
* 完成したコンテンツを多数のユーザーに共有する
#### 共有されたアプリのインストール
    アプリ作成者から共有されたアプリを利用する
* 組織内のユーザーに展開される
* [アプリ] 画面から利用したいアプリを追加して利用する
* ユーザーがアプリの基になるコンテンツを変更することはできない
#### ダッシュボードのアラート機能
    ダッシュボード内のデータが設定したしきい値を超えた場合に通知する
* カード、ゲージ、KPI ビジュアルに対して設定できる
* アラートを自動化し Power Automate と統合できる
#### レポートとダッシュボードの受信登録機能
    レポートやダッシュボードのスナップショットを定期的にメール通知する
#### レポートとダッシュボードの利用状況監視
    ユーザーの利用状況をメトリックとして可視化する
#### ダッシュボードに Excel データを表示する
    [データを取得] で Excel データをアップロードし ダッシュボードにピン止めする
#### Excel で分析 拡張機能
    Power BI のデータに接続した状態で Excel のピボットテーブルやグラフなどの機能を使用できる
#### Power Apps に Power BI を連携させる
#### リアルタイム ストリーミング機能
    リアルタイムでデータをストリーミングしダッシュボードを更新できる

## Power App の機能を理解する
    ビジネス ニーズに合わせたアプリケーションを短時間かつローコーディングで構築する開発環境を提供
* 1つまたは複数のデータソースを使用して高度にカスタマイズされたキャンバス アプリを構築する
* データ モデルとビジネス プロセスから始まる没入型のモデル駆動型アプリを生成する
* Web およびモバイルからアクセス可能なアプリを任意のデバイスで使用する
### キャンバス アプリ
    空白のキャンバスで柔軟に画面レイアウトを自由に作成する
* C# などのプログラミング言語でコードを書くことなくキャンバスからビジネスアプリを設計して構築できる
* PowerPoint のスライドを設計するように部品をドラッグ アンド ドロップしてアプリを設計する
* さまざまなデータ ソースに接続できる
* Web ブラウザ、モバイルアプリ、タブレットで利用できる
* アプリ作成の形式を選択して作成する
    + アプリテンプレート
* コンポーネント
    + ギャラリー：データソースからレコードの一覧を表示するために使用するコントロール
    + フォーム：データの詳細表示や編集を行うためのコントロール
    + 入力コントロール：アプリケーション上で入力するためのさまざまなコントロール
    + メディアコントロール：高度な操作のための豊富なコントロールセット
    + 画面テンプレート：アプリの画面を簡単に作成するためのさまざまなテンプレートが存在する
#### データへの接続
    さまざまなデータと連携したアプリが作成できる
##### 接続済みのコネクタ
    接続されたコネクタは別のアプリケーションでも利用できる
#### アプリの保存・公開・共有
    アプリ作成後チームで利用するには 3 つのステップが必要
1. アプリの保存
    * クラウド上にアプリを保存するとバージョン管理が行われる
2. 公開
    * 運用したいアプリを公開する
3. 共有
    * アプリ公開後 特定のユーザー、グループ、組織全体でアプリを共有する
#### アプリの言語設定
    アプリの実行中や開発中に表示されるテキストはさまざまな言語に翻訳されている
### モデル駆動型アプリ
    ビジネス データをモデル化し そのデータを利用してアプリを構築する
* Dataverse をデータソースとする
* リレーションシップ、フォーム、ビュー、ビジネス ルールなどをデータ レイヤーで定義する
* デバイス間の応答性が高い優れた UI を自動的に生成する
* モデル駆動型アプリを作成する方法
    + ビジネス データのモデル化
    + ビジネス プロセスの定義
    + アプリをビルドする
#### データ
    Dataverse のデータ定義
#### UI
    モデル駆動型アプリのユーザーインターフェースを設定する
* アプリ 
    + アプリのメニューツリー
    + コンポーネント、プロパティ、クライアントの種類、URL を設定する
* サイトマップ
    + アプリのナビゲーションを設定する
    + アプリのメニューツリーを構成する
* フォーム
    + エンティティのデータ入力フィールドのセット
    + アプリに表示したい項目やユーザーに入力させたい項目をカスタマイズする
* ビュー 
    + エンティティのレコードの一覧がアプリでどのように表示されるかを定義する
    + 表示される列、列の幅、並べ替え動作などを定義します
    + 入力したデータを一覧する列をカスタマイズする
#### ロジック
    アプリに適用されるビジネスプロセスやルールを定義する
* ビジネスプロセスフロー 
    + 誰が作業しても同じステップを実行しデータを一貫して入力する
    + 標準的なビジネス プロセスを通じて処理するための定義
    + すべてのユーザーがタスクを同じ方法で実行し処理する
* ワークフロー 
    + ユーザー インターフェイスを持たないビジネス プロセスを自動化する
* アクション 
    + ワークフローから直接ユーザー定義の操作などを手動で呼び出す
* ビジネスルール 
    + 列要件の設定、列の非表示、データ検証などのルールやロジックをフォームに適用する
* フロー 
    + Power Automate と連携させ、通知の取得やファイルの同期、データの収集などを行う
#### ビジュアル化
    アプリ内でグラフィカルにデータの表示を行う
* グラフ
* ダッシュボード
#### アプリの検証と公開
    アプリ作成後、検証および公開をして動作を確認する
#### アプリの共有
    アプリ公開後 特定のユーザー、グループ、組織全体でアプリを共有するc
### Power Apps ポータルについて
    外部に公開する Web サイトを構築する
* Dataverse 上に構築されている
* ポータル Studio やポータル管理アプリを使用して編集する
* 匿名ユーザーまたは認証されたユーザーが利用できる
* ローコードで構築できる
#### Power Apps ポータル Studio
    Web サイトの作成とカスタマイズを行うために使用できるツールが用意されている
#### Web ページとページ テンプレート
    Web ページの作成時にページテンプレートを活用する
#### Web ページのコンポーネント
    コンポーネントをページに配置してさまざまなコンテンツを追加する
#### Web ページのコンポーネント：フォーム
    テーブルに登録された特定のレコードのデータを表示する
#### Web ページのコンポーネント：一覧表示
    テーブルに登録されたレコードの一覧表示
#### ポータルでのテーマの使用
    色・フォント・アウトライン、その他デザイン要素をテーマとして設定する
#### ポータル テンプレート
    プロビジョニング可能なテンプレートを使用することでポータルの構成を加速できる
#### セキュリティ：認証
    認証を実装することで Web ページへのアクセスを制限できる
#### セキュリティ：承認
    ユーザーに対して権限を付与する
#### ポータルのライフサイクル
    ポータルは試用版として作成され必要に応じて運用版に変更する
#### ポータルのメンテナンスモード
    Web サイトがメンテナンス中の場合に適切なメッセージを表示するようポータルを構成する
#### エラーログへのアクセス
    診断ログを有効にし Azure Blob Storage にログを格納する
#### Power Apps のアクセシビリティ
    すべての人に使いやすい製品とサービスの提供に取り組み、ユーザーの年齢、性別、身体的特徴の違いに影響されない使い勝手をサポート


## Power Automate の機能を理解する
    アプリケーションとサービスの間に自動化されたワークフローを作成できる
* コミュニケーション、データの収集、意思決定の承認など、繰り返されるビジネス プロセスの自動化
* 単純な自動化から条件やループなどを使用した高度なシナリオ
* トリガーとアクションで構成される
* オンプレミスおよびクラウドベースのアプリケーションとサービスを自動化する
### Power Automate がもたらす価値
    繰り返し行われるビジネス プロセスを自動化する
* 一般的なシナリオと Power Automate の機能
    + ビジネス プロセスを自動化する
    + 期限を過ぎたタスクのリマインダーを自動送信する
    + スケジュールに基づいてシステム間でビジネス データを移動する
    + 約 300 種類のデータソースまたは公開されている API に接続する
    + Excel でのデータの計算などローカル コンピューターでのタスクを自動化する
### Power Automate で作成できるフロー
* ワークフロー
    + トリガーと 1 つ以上のアクションで構成するフロー
    + 既存のコネクタがあり、さまざまなトリガーとアクションを利用できる
* ビジネス プロセス フロー
    + モデル駆動型アプリで使用しユーザーに操作のガイドを提供する
* UI フロー
    + ロボティック プロセス オートメーション (RPA) フロー
    + Web またはデスクトップ上のタスクを自動化するために使用する
#### ワークフローを構成する要素
    トリガーによってワークフローが開始され、設定したアクションが実行される
#### ワークフローのトリガー ①自動化フロー
    接続したアプリで発生した特定のイベントにより自動的に開始されるフロー
* トリガーの使用例：
    + Outlook のメールボックスにメールが届いた場合
    + ファイルやデータに変更があった場合
#### ワークフローのトリガー ②インスタントフロー
    対応しているアプリ上でユーザーが手動で開始できるフロー
* トリガーの使用例：
    + モバイル アプリで実行ボタンを押す
    + Power Apps 内でボタンを押す
##### インスタントフローの作成
1. トリガーを追加する
2. 新しいステップを追加する
3. コネクタとアクションを設定する
4. アクションのプロパティを設定する
5. フローを保存する
#### ワークフローのトリガー ③スケジュール済みフロー
    フローを実行するタイミングと頻度を自分で設定する
* トリガーの使用例：
    + 特定の時刻に Twitter でツイートする
    + スケジュールに従ってメールを送信する
### アクション：条件
    条件分岐を行うアクション
* 単一の値を別の値と簡単に比較する
* 複数条件を組み合わせた比較を行う場合は [式] を使用する
### 承認フロー
    ドキュメントやプロセスの承認要求を自動化する
* 承認コネクタの使用例：
1. Power Apps アプリで発注リクエストを作成する
2. 情報が Power Automate フローに送信される
3. ユーザーのマネージャーにリクエストを送信する
4. マネージャーがリクエストを承認する
5. ユーザーに承認完了メールが送信される
### ビジネス プロセス フロー
    誰が作業しても同じステップを実行しデータを一貫して入力する
* 決められた流れに沿って遂行したい業務のプロセスを管理する
* 各ステージで収集されるべきデータとプロセスの完了方法をステージとステップで定義し操作を標準化する
### フローのコピーとエクスポート
    既存のフローを変更する場合に使用できるオプション
### トラブルシューティング：エラー特定と検証
    フロー チェッカー機能やテスト機能を使用して作成したフローを検証する
* フロー チェッカーを使用してエラーの特定と修正をする
    + オートメーションの問題とエラーを検出する
    + 潜在的なエラーや警告を検出すると赤色のドットが表示される
* テストを実行し動作を検証する
    + 手動または自動 (以前の実行結果を選択) でテストする
    + 実行したフローを監視しエラー原因を特定する
    + ステップごとに実行結果を確認できる
### トラブルシューティング：フローの実行履歴
    実行履歴でフローの実行状況や結果を確認する
### トラブルシューティング：修復のヒント
    オートメーションが失敗した場合、作成者や所有者に修復のヒントが自動的にメールで送信される


## Power Virtual Agents の機能を理解する
    データ サイエンティストや開発者がいなくても誰でも強力なチャットボットを作成できる
* コードの記述を必要とせずチャットボットを作成できる
* 仮想オペレーターが顧客の代わりにアクションを実行する
* AI を活用してボットのパフォーマンスを向上する
* 誰でも気軽に作成できるチャットボット
    + コードや AI の知識を必要とせずにチャットボットを作成できる
    + 問い合わせ対応を自動化しコストを削減できる
    + 24 時間 365 日問題を解決し顧客満足度を向上させる
* Power Automate と連携
    + チャットから Power Automate アクションを実行する
    + 実行済みの Power Automate からデータを取得する
### チャットボットの構築
#### コンポーネント：トピック
    想定される質問に基づき、チャットボットの会話の展開方法を定義する
* 特定の問題に関連してユーザーが入力する可能性が高いキーワード、または質問であるトリガーフレーズを構成する
* トピックを設定した後、会話の展開方法を構成する
##### トピックの操作
    トピックの会話パスをデザインする
#### コンポーネント：エンティティ
    AI がユーザーの意図を自然言語として理解するために設定する機能
* ユーザーの応答から特定の種類の情報を理解し識別する
* 自然言語の理解により応答と同じようなフレーズがトリガーフレーズに含まれていなくても関連したトピックに関連付ける
* エンティティを定義しボットに知識を与える作業が完了すると会話を構築するときに使用できる
#### コンポーネント：変数
    変数に顧客からの応答内容を保存し後の会話で再利用する
#### コンポーネント：アクション ①フロー
    Microsoft Power Automate を呼び出してチャットボットがアクションを実行する
* トピック内から Power Automate を呼び出す
    + 既存のフローを利用する
    + Power Virtual Agents キャンバス内で作成する
#### コンポーネント：アクション ②認証
    トピックにエンド ユーザー認証を追加する
* 使用可能な認証変数
    + UserDisplayName
    + UserID
    + IsLoggedIn
    + AuthToken
#### チャットボットをテストする
#### ボットの共有
    ボットを他のユーザーと共有し、複数ユーザーで編集、管理、共同作業する


## Microsoft Dataverse
    クラウド上で提供される SaaS データベース
* ビジネス ロジックを組み込んだ標準化されたデータ モデル
* 独自のニーズに拡張し、アプリやサービス全体に統合する
* シームレスな Dynamics 365、Office 365、Azure 統合
* レコードが変更された場合に Outlook メールを送信する
### Dynamics 365 との関係性
    Dynamics 365 アプリケーションは Dataverse を使用してデータを保存および保護する
### 機能
* セキュリティ : Azure Active Directory (AAD) による認証を処理
* ロジック : データ レベルでビジネス ロジックを簡単に適用できる
* データ :データを形成するためのコントロールを提供
* ストレージ : 物理データが Azure 上に格納される
* 統合 : API、Webhooks、データ エクスポートなどによりデータのイン/アウトを柔軟に実現
### 環境
    開発環境、テスト環境、運用環境
* 開発用、テスト用、本番用の環境を設定することでソリューション開発やデータ ストレージの管理を効果的に行うことができる
* 格納データは規定で暗号化される
### 構造
    データ構造を格納するためのテーブルと列
* 標準テーブル : CDM による定義済みの基本セットやカスタムなテーブル
* 活動テーブル : 電子メール、電話、FAX などの活動の記録
* 列
    + テーブルのレコード内に個々の情報を格納する
    + すべての列にはデータの格納方法を定義する型がある (例: 日付型）
### 所有権
    ユーザー定義標準エンティティの所有権。標準エンティティの所有権は後から変更不可
* ユーザー または チーム 
    + データはユーザーまたはチームに属す
    + 実行できる操作はユーザー レベルで管理できる
    + 5 段階のアクセスレベル
    + 実際の業務において多くの場合このレベルを使用
* 組織 • データは組織に属す
    + データへのアクセスは組織レベルで管理される
    + 2 段階のアクセスレベル(ユーザーが操作を実行できるかできないか)
### データ定義
    規定で定義されているデータ定義
* すぐにデータベースを利用可能にする既定のスキーマ定義
* 標準化された形式でデータを構築し各アプリで同じデータを使用できる
* データスキーマを公開することで他メーカーとも連携可能
### ビジネスルール
    アプリ レベルではなくデータ レベルでビジネスルールを適用することでデータをより適切に制御できる
* ビジネスロジックの例
    + 与信限度額が $1,000,000 を超える場合、「与信限度額 VP 承認者」 フィールドを必須フィールドに変更するように構成する
#### ビジネス ルールの編集
    既存のビジネスルールを編集するにはビジネスルールを [非アクティブ化] してから条件を変更する


## 参考
https://www.microsoft.com/ja-jp/biz/dynamics/power-platform.aspx?aaid=PFUNRL
https://info.microsoft.com/JA-RapidApps-CNTNT-FY22-04Apr-13-Power-Apps-Special-Edition-SRGCM6591_LP01-Registration---Form-in-Body.html?aaid=PFUNRL
https://info.microsoft.com/JA-PowerApps-CNTNT-FY21-01Jan-08-PowerAutomatecan-SRGCM4179_01Registration-ForminBody.html?aaid=PFUNRL
https://info.microsoft.com/JA-DBI-WBNR-FY22-09Sep-13-MKTO-FY22-Power-BI-Webinar-0913-SRDEM83223_LP02-On-Demand-Registration---Form-in-Body.html?aaid=PFUNRL
https://info.microsoft.com/JA-DBI-WBNR-FY22-02Feb-16-MKTO-FY22-Power-BI-Webinar-0216-SRDEM100922_LP02-On-Demand-Registration---Form-in-Body.html?aaid=PFUNRL
https://info.microsoft.com/JA-PowerAuto-CNTNT-FY22-09Sep-30-Power-Automate-Desktop-SRGCM4999_LP01-Registration---Form-in-Body.html