#
## 機械学習ソリューションの設計と準備 (20 - 25%)
### Microsoft Azure AI Fundamentals: 機械学習用のビジュアル ツールについて調べる
#### Azure Machine Learning で自動機械学習を使用する
* 機械学習とは
    + 機械学習は、数学と統計を使用して、不明な値を予測できるモデルを作成する手法です
* 教師あり
    + 回帰: 継続的な値を予測するために使用されます (価格、売上の合計、その他の測定値など)。
    + 分類: バイナリ クラス ラベルを決定するために使用されます (患者が糖尿病にかかっているかどうかなど)。
* 教師なし
    + クラスタリング: 類似する情報をラベル グループにグループ化してラベルを決定するために使用されます (鳥から種への、測定値のグループ化など)。
* Azure Machine Learning スタジオ
    + ワークスペース
    + コンピューティング インスタンス: データ サイエンティストがデータおよびモデルを操作するために使用できる開発ワークステーション。
    + コンピューティング クラスター: 実験コードをオンデマンドで処理するための、仮想マシンのスケーラブルなクラスター。
    + 推論クラスター: トレーニング済みモデルを使用する予測サービスのデプロイ ターゲット。
    + アタッチされたコンピューティング: Virtual Machines や Azure Databricks クラスターなど、既存の Azure コンピューティング リソースへのリンク。
* 自動機械学習
* AutoMLプロセス
    1. データの準備: データセットの特徴とラベルを特定します。 必要に応じて、データの事前処理、クリーニング、変換を行います。
    2. モデルのトレーニング: データを、2 つのグループ (トレーニング セットと検証セット) に分割します。 トレーニング データセットを使用して機械学習モデルをトレーニングします。 検証データセットを使用して、機械学習モデルのパフォーマンスをテストします。
    3. パフォーマンスの評価: モデルの予測と既知のラベルを比較してどの程度近いかを評価します。
    4. 予測サービスをデプロイする: 機械学習モデルをトレーニングしたら、サーバーまたはデバイスでモデルをアプリケーションとしてデプロイして、他のユーザーがそれを使用できるようにすることができます。
#### Azure Machine Learning デザイナーを使用して回帰モデルを作成する
* 回帰機械学習シナリオを特定する
    + 回帰では、変数または "特徴" に基づいて数値 "ラベル" または結果を予測します。
    + 平方フィートや部屋数など、住宅の特性を使用して住宅価格を予測します。
    + 天候や土壌の質など、農場環境の特性を使用し、作物の収穫量を予測します。
    + 広告ログなど、過去のキャンペーンの特性を使用し、将来の広告クリック数を予測します。
* Azure Machine Learning デザイナーを使用して回帰モデルをトレーニングする
    + ラベルの特徴と既知の値の両方を含むデータを使用してモデルをトレーニングする
* 回帰の手順
    1. データの準備: データセットの特徴とラベルを特定します。 必要に応じて、データの事前処理、クリーニング、変換を行います。
    2. モデルのトレーニング: データを、2 つのグループ (トレーニング セットと検証セット) に分割します。 トレーニング データセットを使用して機械学習モデルをトレーニングします。 検証データセットを使用して、機械学習モデルのパフォーマンスをテストします。
    3. パフォーマンスの評価: モデルの予測と既知のラベルを比較してどの程度近いかを評価します。
    4. 予測サービスのデプロイ: 機械学習モデルをトレーニングしたら、トレーニング パイプラインをリアルタイム推論パイプラインに変換する必要があります。 その後、他のユーザーが使用できるようにモデルをアプリケーションとしてサーバーまたはデバイスにデプロイできます。
* モデルの評価
    + 平均絶対誤差 (MAE):予測値と真の値の差の平均。 この値は、ラベルと同じ単位 (この例ではドル) に基づいています。 この値が小さいほど、モデルの予測が正確です。
    + 二乗平均平方根誤差 (RMSE):予測と真の値の平均二乗の平方根の差。 結果は、ラベルと同じ単位 (ドル) に基づくメトリックになります。 MAE (上記) と比較すると、差が大きいほど個々の誤差の分散が大きくなることを示します (たとえば、一部の誤差が非常に小さく、他の誤差が大きい場合など)。
    + 相対二乗誤差 (RSE):予測と真の値の差の 2 乗に基づく、0 から 1 の間の相対的なメトリック。 このメトリックが 0 に近いほど、モデルのパフォーマンスが高くなります。 このメトリックは相対的なものであるため、ラベルの単位が異なるモデルを比較するために使用できます。
    + 相対絶対誤差 (RAE):予測と真の値の絶対差に基づく、0 から 1 の間の相対的なメトリック。 このメトリックが 0 に近いほど、モデルのパフォーマンスが高くなります。 RSE と同様に、このメトリックは、ラベルの単位が異なるモデルを比較するために使用できます。
    + 決定係数 (R2):このメトリックは、通常は "R-2 乗" と呼ばれ、予測と真の値の間の分散の量がモデルによって説明される方法を要約します。 この値が 1 に近いほど、モデルのパフォーマンスが高くなります。
* 推論に回帰モデルを使用する
* 回帰モデルをサービスとしてデプロイする
#### Azure Machine Learning デザイナーを使用して分類モデルを作成する
* 分類機械学習のシナリオを特定する。
    + 臨床データを使用して、患者が病気になるかどうかを予測する
    + 履歴データを使用し、テキストのセンチメントが肯定的か、否定的か、中立かを予測します。
    + 小規模企業の特性を使用して、新しいベンチャー企業が成功するかどうかを予測する
* Azure Machine Learning デザイナーを使用して分類モデルをトレーニングする。
    1. データの準備: データセットの特徴とラベルを特定します。 必要に応じて、データの事前処理、クリーニング、変換を行います。
    2. モデルのトレーニング: データを、2 つのグループ (トレーニング セットと検証セット) に分割します。 トレーニング データセットを使用して機械学習モデルをトレーニングします。 検証データセットを使用して、機械学習モデルのパフォーマンスをテストします。
    3. パフォーマンスの評価: モデルの予測と既知のラベルを比較してどの程度近いかを評価します。
    4. 予測サービスのデプロイ: 機械学習モデルをトレーニングしたら、トレーニング パイプラインをリアルタイム推論パイプラインに変換する必要があります。 次に、他のユーザーが使用できるようにモデルをアプリケーションとしてサーバーまたはデバイスにデプロイできます。
* 推論に分類モデルを使用する。
* 混同行列
    + 正確性: 予測の合計数に対する正しい予測 (真陽性 + 真陰性) の比率。
    + 精度: 陽性として分類され、実際に陽性だったケースの割合 (真陽性の数を真陽性と擬陽性の合計数で割った値)。
    + 再現率: 正しく識別された陽性のケースの割合 (真陽性の数を真陽性と擬陰性の合計数で割った値)。
    + F1 スコア: 実質的に精度と再現率を組み合わせた、全体的なメトリック。
* 閾値
* ROC 曲線と AUC メトリック
* 分類モデルをデプロイし、テストする。
    + 推論パイプライン
#### Azure Machine Learning デザイナーを使用してクラスタリング モデルを作成する
* Azure Machine Learning デザイナーを使用して、クラスタリング モデルをトレーニングする。
* 推論にクラスタリング モデルを使用する。
* クラスタリング モデルをサービスとしてデプロイする。

### Azure Machine Learning を使用した機械学習ソリューションの構築と運用
* 機械学習ワークロードのスケーラブルなオンデマンド コンピューティング。
* 幅広いソースからデータを取り込むためのデータ ストレージと接続。
* モデルのトレーニング、デプロイ、管理のプロセスを自動化するための、機械学習ワークフローの調整。
* モデルの登録と管理。これにより、複数のバージョンのモデルと、それらのモデルをトレーニングしたデータを追跡できます。
* トレーニングの実験、データセット、公開されたサービスのメトリックと監視。
* リアルタイムおよびバッチ推論のためのモデル デプロイ。
#### Azure Machine Learning SDK の概要
* 好みの開発環境から機械学習の操作を実行する。
* 資産の作成と構成を自動化して、反復可能にする。
* 複数の環境 (開発、テスト、運用など) でレプリケートする必要があるリソースの一貫性を確保する。
* 継続的インテグレーション/継続的デプロイ (CI/CD) パイプラインなどの開発者の運用 (DevOps) ワークフローに機械学習の資産構成を組み込むことができます。
#### Azure Machine Learning を使用して機械学習モデルをトレーニングする
* 運用機械学習のシナリオ
    + 複数のコンピューティング環境用の再利用可能なトレーニング スクリプトを作成する。
    + トレーニングと評価のプロセス中にモデルのパフォーマンス メトリックをログに記録する。
    + モデルのバージョンを追跡する。
* ScriptRunConfig を使用して、モデル トレーニング スクリプトを Azure Machine Learning の実験として実行する。
* 再利用可能なパラメーター化されたトレーニング スクリプトを作成する。
* トレーニング済みのモデルを登録する。
#### Azure Machine Learning でのデータの操作
* データストアを作成し使用する
* データストアの種類
    + Azure Storage (BLOB およびファイル コンテナー)
    + Azure Data Lake Store
    + Azure SQL データベース
    + Azure Databricks ファイル システム (DBFS)
* データストアに関する考慮事項
    + Azure Blob Storage を使用する場合、premium レベルのストレージにより、大規模なデータセットの I/O パフォーマンスが向上する可能性があります。 ただし、このオプションを使用するとコストが増加し、データの冗長性用のレプリケーション オプションが制限される可能性があります。
    + データ ファイルを使用する場合、CSV 形式が非常に一般的ですが、通常は Parquet 形式の方がパフォーマンスが向上します。
    + 名前でどのデータストアにもアクセスできますが、既定のデータストア (これは最初は組み込みの workspaceblobstore データストアです) を変更することを検討できます。
* データセットの概要
    + データセットは、実験やパイプラインで簡単に使用できる、バージョン管理されパッケージ化されたデータ オブジェクトです
* データセットの種類
    + 表形式: データはデータセットから表として読み取られます。 データが一貫して構成されており、Pandas データフレームなどの一般的な表形式のデータ構造内でそれを操作する場合、この種類のデータセットを使用する必要があります。
    + ファイル: データセットは、ファイル システムからのように読み取ることのできるファイル パスのリストを提示します。 データが構造化されていない場合や、ファイル レベルでデータを処理する必要がある場合 (たとえば、一連のイメージ ファイルから畳み込みニューラル ネットワークをトレーニングする場合) は、この種類のデータセットを使用します。
* データセットを作成し使用する
#### Azure Machine Learning でのコンピューティング処理
* 環境を作成して使用する。
    + 仕様ファイルからの環境の作成
    + 既存の Conda 環境から環境を作成する
    + パッケージを指定した環境の作成
* コンピューティング先を作成して使用する。
    + SDK を使用したマネージド コンピューティング先の作成
    + アンマネージド コンピューティング先の SDK へのアタッチ
    + 既存のコンピューティング先の確認
#### パイプラインを使用して機械学習を調整する
* Azure Machine Learning パイプラインを作成する。
* パイプラインのステップ
    + PythonScriptStep: 指定された Python スクリプトを実行します。
    + DataTransferStep: Azure Data Factory を使用してデータ ストア間でデータをコピーします。
    + DatabricksStep: Databricks クラスターでノートブック、スクリプト、またはコンパイル済み JAR を実行します。
    + AdlaStep: Azure Data Lake Analytics で U-SQL ジョブを実行します。
    + ParallelRunStep - 複数のコンピューティング ノードで分散タスクとして Python スクリプトを実行します。
* Azure Machine Learning パイプラインを発行する。
* Azure Machine Learning パイプラインのスケジュールを設定する。
#### Azure Machine Learning を使用してリアルタイム機械学習サービスをデプロイする
* リアルタイムの推論サービスを使用する
#### Azure Machine Learning を使用してバッチ推論パイプラインをデプロイする
1. モデルを登録する
2. スコアリング スクリプトを作成する
3. ParallelRunStep を使用してパイプラインを作成する
4. パイプラインを実行してステップの出力を取得する
* トレーニング済みのモデルのバッチ推論パイプラインを発行する。
* バッチ推論パイプラインを使用して予測を生成する。
    + バッチ推論パイプラインを作成する。
    + パイプラインを REST サービスとして公開する。
    + REST エンドポイントを介してパイプラインを実行する。
#### Azure Machine Learning でハイパーパラメーターを調整する
* ハイパーパラメーター検索空間を定義します。
    + "ロジスティック回帰" アルゴリズムでは、"正則化率" ハイパーパラメーターを使用してオーバーフィットを打ち消すことができます
    + 畳み込みニューラル ネットワーク (CNN) のディープ ラーニング手法では、トレーニング中の重みの調整方法を制御する "学習率" や、各トレーニング バッチに含まれるデータ項目の数を決定する "バッチ サイズ" などのハイパーパラメーターを使用する
* ハイパーパラメーターのサンプリングを構成します。
    + グリッド サンプリング
        - グリッド サンプリングは、すべてのハイパーパラメーターが不連続の場合にのみ使用できます
    + ランダム サンプリング
        - ランダム サンプリングは、各ハイパーパラメーターの値をランダムに選択するために使用されます
    + ベイジアン サンプリング
        - ベイジアン サンプリングでは、ベイジアン最適化アルゴリズムに基づいてハイパーパラメーター値を選択する
* 早期終了ポリシーを選択します。
    + バンディット ポリシー
        - バンディット ポリシーを使用すると、ターゲット パフォーマンス メトリックがそれまでの最適な実行を指定されたマージンで下回っている場合、実行を停止することができます
    + 中央値の停止ポリシー
        - 中央値の停止ポリシーでは、ターゲット パフォーマンス メトリックがすべての実行の移動平均の中央値を下回っている実行を破棄します。
    + 切り捨て選択ポリシー
        - 切り捨て選択ポリシーでは、X に対して指定した truncation_percentage 値に基づいて、各評価間隔でパフォーマンスが低い X% の実行を取り消します
* ハイパーパラメーター調整実験を実行します。
    + ハイパーパラメーター調整用のトレーニング スクリプトを作成する
        - 変更するハイパーパラメーターごとに引数を含めます。
        - ターゲット パフォーマンス メトリックをログに記録します。 これにより、ハイパードライブの実行によって開始された子実行のパフォーマンスが評価され、最適なパフォーマンスのモデルが生成されるものを特定できます。
    + ハイパードライブ実験の構成と実行
    + ハイパードライブの実行の監視と確認
#### Azure Machine Learning service で機械学習モデルの選択を自動化する
* Azure Machine Learning の自動機械学習機能を使用して、データに最適なパフォーマンスを実現するアルゴリズムを決定する。
* 分類アルゴリズム
    + ロジスティック回帰
    + 軽量勾配ブースティング マシン (GBM)
    + 意思決定ツリー
    + ランダム フォレスト
    + Naive Bayes
    + 線形サポート ベクター マシン (SVM)
    + XGBoost
    + ディープ ニューラル ネットワーク (DNN) 分類子
* 回帰アルゴリズム
    + 線形回帰
    + 軽量勾配ブースティング マシン (GBM)
    + 意思決定ツリー
    + ランダム フォレスト
    + Elastic Net
    + LARS Lasso
    + XGBoost
* 予測アルゴリズム
    + 線形回帰
    + 軽量勾配ブースティング マシン (GBM)
    + 意思決定ツリー
    + ランダム フォレスト
    + Elastic Net
    + LARS Lasso
    + XGBoost
* 自動機械学習を使用して、トレーニングのためのデータの前処理を行う。
* 自動機械学習の実験を実行します。
#### 差分プライバシーを探索する
    差分プライバシーは、分析プロセスに統計的 "ノイズ" を追加することによって、個々のデータ値を保護しようとするものです
    SmartNoise パッケージを使用して、差分プライバシーを自身で探索することができます。
* データ プライバシーの問題を明確にする
* 差分プライバシーのしくみについて説明する
* 差分プライバシーのパラメーターを構成する
* 差分プライベート データ分析を実行する
#### Azure Machine Learning を使用して機械学習モデルを説明する
* "グローバル" および "ローカル" の特徴量の重要度を解釈します。
    + グローバル特徴量の重要度は、テスト データセット全体における各特徴量の相対的な重要度を定量化します。 これにより、データセット内の各特徴量が予測に影響を与える程度の一般的な比較が提供されます。
    + ローカル特徴量の重要度では、個別の特定の予測に対する各特徴量の値の影響が測定されます。
* Explainer を使用してモデルを解釈します。
    + ローカル モデルを解釈するには、azureml-interpret パッケージをインストールし、それを使用して Explainer を作成する必要があります。
    + MimicExplainer -トレーニング済みのモデルの近似値を求め、説明を生成するために使用できる "グローバル サロゲート モデル" を作成するための Explainer です。 この説明可能なモデルには、トレーニング済みのモデルと同じ種類のアーキテクチャが必要です (たとえば、線形またはツリーベース)。
    + TabularExplainer -さまざまな SHAP Explainer アルゴリズムのラッパーとして機能し、モデル アーキテクチャに最適なものを自動的に選択するための Explainer です。
    + PFIExplainer - 特徴量の値をシャッフルし、予測パフォーマンスへの影響を測定することにより、特徴量の重要度を分析するための "順列特徴量の重要度" Explainer です。
* トレーニング実験でモデルの説明を作成します。
    + 実験スクリプトで説明を作成するには、実行環境に azureml-interpret と azureml-contrib-interpret の両方のパッケージがインストールされている
* モデルの説明を視覚化します。
    + Azure Machine Learning スタジオのモデルの説明には、特徴量の重要度を調べるために使用できる複数の視覚化が含まれています
#### Azure Machine Learning を使用したモデルの不公平性の検出と緩和
* 機械学習モデルの公平性を評価する。
    + モデルの公平性を評価する 1 つの方法は、"センシティブ特徴" 内の各グループの "予測" を比較すること
* 機械学習モデルの予測の不一致を緩和する。
    + 回帰や分類のような教師ありの手法で機械学習モデルをトレーニングする場合、ホールドアウト検証データに対して達成されたメトリックを使用して、モデルの全体的な予測パフォーマンスを評価します
    + センシティブ特徴グループ間の予測率または予測パフォーマンス メトリックに不一致がある場合、考えられる原因を検討することをお勧めします
    + データの不均衡。 
        - 一部のグループがトレーニング データで過大評価されていたり、データが歪んでいて、特定のグループのケースが全体を代表していない場合があります。
    + 間接的な相関関係。 
        - センシティブ特徴自体がラベルの予測にならないことがありますが、センシティブ特徴と他の特徴の間に、予測に影響する隠れた相関関係が存在する場合があります。 
    + 社会的偏り。 
        - データの収集、準備、モデル化のプロセスにおける潜在的な偏りが、特徴の選択やモデル設計の他の側面に影響を与えている可能性があります。
    + 偏りの緩和
        - トレーニング データと検証データのバランスを取ります
        - 広範な特徴選択とエンジニアリング分析を実行します
        - 重要な特徴に基づいて、モデルの不一致を評価します。 モデルの偏りを定量化できないと、それを簡単に解決することはできません。
        - センシティブ特徴グループ間の予測パフォーマンスの不一致を小さくするために、全体的な予測パフォーマンスをトレードオフします
* Fairlearn 
    + モデルを分析し、1 つ以上のセンシティブ特徴に対する予測と予測パフォーマンスの不一致を評価するために使用できる Python パッケージです
#### Azure Machine Learning を使用してモデルを監視する
* Application Insights を有効にして Azure Machine Learning We サービスを監視する。
    + Azure Machine Learning service から、Application Insights にテレメトリをログするには、ご利用の Azure Machine Learning ワークスペースに関連付けられた Application Insights リソースを用意する必要があります。
    + Application Insights リソースを使用してテレメトリをログするようにサービスを構成する必要があります。
* モデルのテレメトリを取り込んで表示する。
    + Application Insights を有効にすると、標準出力およびエラー ログに書き込まれた情報が自動的に取り込まれます。
    + クエリ機能を使用して、これらのログ内のデータを表示できるようになります。
#### Azure Machine Learning を使用してデータ ドリフトを監視する
* データ ドリフト モニターを作成する。
    + Azure Machine Learning は、データセットを使用したデータ ドリフトの監視をサポートしています。 データセット内の新しい特徴データをキャプチャし、モデルのトレーニングに使用したデータセットと比較できます
    + 登録済みのデータセットを使用してデータ ドリフトを監視するには、次の 2 つのデータセットを登録する必要があります
        - "ベースライン" データセット - 通常は元のトレーニング データ。
        - 時間間隔に基づいてベースラインと比較される "ターゲット" データセット。 このデータセットには、比較する各特徴の列と、データ ドリフト率を測定するためのタイムスタンプ列が必要です。
* データ ドリフトの監視のスケジュールを設定する。
    + データ モニターを定義するときに、その実行スケジュールを指定します。 
    + データ ドリフト率のしきい値と、このしきい値を超えた場合に通知するためのオペレーターのメール アドレスを指定できます
* データ ドリフトの監視結果を表示する。
#### Azure Machine Learning のセキュリティの概念について調べる
* Azure Machine Learning のロールベースのアクセス制御を適用し、理解する
    + ユーザーロール
    + カスタムロール
* Azure Machine Learning でのシークレットの管理方法を説明する
    + AD
    + マネージドID
    + KeyValutとシークレット
* Azure Virtual Network で Azure Machine Learning ワークスペースを使用する
    + 仮想ネットワークとセキュリティグループ
    + ワークスペースとリソースの保護
    + セキュリティグループとトラフィック
    + サービスタグ
    プライベートエンドポイントとプライベートリンク

## データの探索とモデルのトレーニング (35 - 40%)
### 機械学習モデルを作成する
#### Python を使用してデータを探索して分析する
* NumPy と Pandas を使用すると、データの分析と操作が簡略化されます
* Matplotlib では、魅力的なデータ視覚化が提供されます
* Scikit-learn では、シンプルで効果的な予測データ分析が提供されます
* TensorFlow と PyTorch では、機械学習とディープ ラーニングの機能が提供されます
* データの視覚化：Matplotlib 
    + matplotlib を使ってグラフを作成した
    + グラフをカスタマイズする方法を見た
    + 中央値のような基本的な統計量を計算した
    + 箱ひげ図やヒストグラムを使ってデータの広がりを見た
    + サンプルと母集団について学んだ
    + 成績のサンプルからグラフの母集団がどのように見えるかを推定した。
* 実際のデータの問題
    + 欠損値と記録データの不備を検査する
    + 明らかな外れ値の削除を検討する
    + 分析に影響を与える可能性のある実際の要因を考慮し、データセットのサイズがこの問題に対応できるだけの大きさであるかどうかを検討する
    + 生データに偏りがないか検査し、見つかった場合は修正するためのオプションを検討する
#### 回帰モデルをトレーニングして評価する
* 回帰とは
    + 回帰は、観察される対象の特性を表すデータの変数 ("特徴" と呼ばれます) と、予測しようとしている変数 ("ラベル" と呼ばれます) の間にリレーションシップを確立することによって機能します。
* 回帰モデル
    + 線形回帰は最も単純な回帰形式で、使用される特徴の数に制限はありません。 線形回帰には多くの形式があります。多くの場合、使用される特徴の数と、適合する曲線の形状によって名前が付けらます。
    + デシジョン ツリーでは、変数を予測するためのステップ バイ ステップのアプローチが採用されています。 自転車の例で考える場合、デシジョン ツリーで、最初に春夏と秋冬に分割し、それを曜日に基づいて予測することができます。 春夏の月曜日の自転車レンタル料金を 1 日あたり 100 に設定し、秋冬の月曜日のレンタル料金を 1 日あたり 20 に設定することができます。
    + アンサンブル アルゴリズムでは、1 つのデシジョン ツリーだけでなく、多数のツリーが構築されるため、より複雑なデータに対するより優れた予測が可能になります。 ランダム フォレストなどのアンサンブル アルゴリズムは、強力な予測機能により、機械学習や科学で広く使用されています。
* モデルの改善
    + データの前処理
    + ハイパーパラメータの調整
#### 分類モデルをトレーニングして評価する
* 分類とは
    + 分類は、"教師あり" の機械学習手法の例です。つまり、既知の "特徴" 値 (たとえば、患者の診断測定値) および既知の "ラベル" 値 (たとえば、非糖尿病または糖尿病の分類) を含むデータに依存することを意味します。 
* 他クラス分類
    + 複数の2項分類の組み合わせ
#### クラスタリング モデルをトレーニングして評価する
* クラスタリングとは
    + クラスタリングは、オブジェクトの類似性に基づいてオブジェクトをグループ化するプロセスです。 
    + クラスタリングと分類のモデルの主な違いは、クラスタリングが "教師なし" メソッドであり、"トレーニング" がラベルなしで行われる点です。 
    + どのようにしてデータをいくつのクラスタに分けるかを知ることができるかということです。この問題を解決する一つの方法は、データサンプルを使って、クラスタ数を増加させたクラスタリングモデルを作成し、各クラスタ内でデータポイントがどれだけ厳密にグループ化されたかを測定することである。この緊密さを測定するためによく使われる指標は、クラスタ内平方和（WCSS）で、値が小さいほどデータポイントが近いことを意味します。
* K-Means クラスタリング
* 階層クラスタリング
    + データをグループに分割するだけでなく、これらのグループ間の関係を理解するのにも役立つ
#### ディープ ラーニング モデルをトレーニングして評価する
* トレーニング
* 損失関数と逆伝播
* 学習率と過学習
* 畳み込みニューラルネットワーク：CNN
    + ドロップ層
    + 平坦化層
    + 完全に接続された層
* 転移学習


## デプロイ用のモデルを準備する (20 - 25%)
### Azure Databricks を使用した機械学習ソリューションの構築と運用
#### Azure Databricks を使ってみる
* Azure Databricks の主な概念について説明する。
    + Azure Databricks は、Apache Spark の最適化バージョンである Databricks Runtime と呼ばれる独自のデータ処理エンジン上で実行されます
    1. クラスター: 評価リソースのセットであり、ここでコードを実行します。
    2. ワークスペース: すべての Databricks 要素、クラスター、ノートブック、データをグループ化します。
    3. ノートブック: 実行可能コード、説明テキスト、視覚化が含まれるドキュメントです。
* ワークスペースとクラスターを操作する。
    + ワークスペース
        - オブジェクト (ノートブック、ライブラリ、実験など) をフォルダーにグループ化する、
        - データへのアクセスを提供する、
        - 使用される評価リソース (クラスター、ジョブ) へのアクセスを提供する。
    + クラスター
        - 汎用クラスター。 複数のユーザーでこのようなクラスターを共有して、共同作業による対話型分析を行うことができます。
        - 特定のジョブを実行するジョブ クラスター。
* ノートブックを操作する。
    + 実行可能コード
    + 説明テキスト
    + 視覚化
#### Azure Databricks でデータを操作する
* データフレームについて説明する。
    + Spark では、RDD、データフレーム、データセットという 3 つの異なる API が使用されます
    + データフレームは、さまざまなソース (CSV ファイル、JSON、Parquet ファイル、Hive テーブル、ログ テーブル、外部データベースなど) から作成できます
* データフレームのクエリを実行する。
    + Spark では、最適化エンジンを使用して論理クエリが生成されます。 データはクラスターに分散され、大量のデータでも高いパフォーマンスが実現されます
* Spark を使用してデータを視覚化する。
    + データフレーム内の行を出力できる組み込み関数 show があります
    + Azure Databricks には、独自の表示機能が追加され、display および displayHTML 関数を使用して、その他のさまざまな種類の視覚エフェクトがすぐに追加されます
#### Azure Databricks を使用して機械学習用のデータを準備する
* 機械学習の概要について説明する。
* データのクリーニングを実行する。
    + null 値の補完
    + データ型の変換
    + 重複するレコード
    + 外れ値
* 特徴エンジニアリングを実行する。
    + 集計 (カウント、合計、平均、平均値、中央値など)
    + パーツ (日付の年、日付の月、日付の週など)
    + ビン分割 (エンティティをビンにグループ化してから集計を適用する)
    + フラグを設定する (ブール条件の結果は True または False)
    + 頻度ベース (1 つ以上のカテゴリ変数レベルの頻度を計算する)
    + 埋め込む (場合によっては異なるカーディナリティを使用して、1 つ以上のカテゴリまたはテキスト機能を新しい機能セットに変換する)
    + 派生の例
* データのスケーリングを実行する。
    + 正規化:データが範囲 [0, 1] に数学的に再スケーリングされます
    + 標準化:データが平均値 = 0、標準偏差 = 1 に再スケーリングされます
* データのエンコードを実行する。
    + 序数エンコード:カテゴリ データが 0 から (カテゴリの数 - 1) までの整数コードに変換されます
    + one-hot エンコード:推奨されるアプローチは One Hot エンコードです

#### Azure Databricks を使用して機械学習モデルをトレーニングする
* Spark ML について説明する。
    + 1 つのキー ライブラリがあり、Apache Spark に対してネイティブな MLLib と Spark ML という 2 つのアプローチがあります。
    + MLLib
        - Apache Spark での機械学習のレガシ アプローチです
    + Spark ML
        - Apache Spark の機械学習開発用の主要なライブラリです
* 機械学習モデルをトレーニングして検証する。
    1. データの分割。
        + トレーニングと検証のデータセット間でデータを分割する必要があります
    2. モデルをトレーニングする。
        + モデルのトレーニングは、変換器、推定器、パイプラインの 3 つの主要な抽象的概念に依存します
    3. モデルの検証。
        + 二乗平均平方根誤差 (RMSE)、平均絶対誤差 (MAE)、決定係数 (Rsummary、アールスクエアと読む) などのスコアが含まれます
* 他の機械学習フレームワークを使用する。
    + Azure Databricks は、Spark ML と MLLib 以外の機械学習フレームワークをサポートしています。 
    + Azure Databricks では、TensorFlow や PyTorch などの、一般的なライブラリのサポートが提供されています

#### MLflow を使用して Azure Databricks で実験を追跡する
* MLflow の機能について説明する。
    + 機械学習の開発ライフサイクルを管理するために設計されたオープンソース製品です
    + 主要な運用プロセスと Azure Databricks インターフェイスが統合される
    + 製品コンポーネント
        - MLflow Tracking:実験を行うことができます
        - MLflow Projects:一貫性のあるデプロイを実現
        - MLflow Models:配布用にモデルをパッケージ化する
        - MLflow Model Registry:モデルをレジストリに登録できます
* MLflow の用語について説明する。
    + MLflow Tracking
        - パラメーター: 入力を表すキーと値のペア。 パラメーターを使用して、機械学習プロセスに影響を与えるハイパーパラメーター (関数への入力) を追跡します。
        - メトリック: モデルのパフォーマンスを表すキーと値のペア。 これには、二乗平均平方根誤差などの評価メジャーを含めることができます。メトリックは、実行中に更新できます。 これにより、データ科学者は、たとえば、ニューラル ネットワークの各エポックの二乗平均平方根誤差を追跡できます。
        - 成果物: 出力ファイル。 成果物は任意の形式で格納でき、モデル、画像、ログ ファイル、データ ファイルの他、モデルの分析と理解に重要なものを含めることができます。
    + MLflow Projects
        - プロジェクト: データ サイエンス コードをパッケージ化する方法
        - エントリ ポイント: プロジェクトの使用の始点として機能することを目的としたファイル
    + MLflow Models
        - モデル: 任意のファイル セットを含むディレクトリ
        - フレーバー: どのツールまたはライブラリでモデルが生成されたのかを示す記述子
    + MLflow Model
* MLflow で実行を開始する。
    + 実験と呼ばれるコレクション内のトレーニング実行を追跡できます
#### Azure Databricks で機械学習モデルを管理する
* モデル管理に関する考慮事項について説明する。
* モデルを登録する。
* モデルのバージョンを管理する。
#### Azure Machine Learning で Azure Databricks の実験を追跡する
* Azure Machine Learning について説明する
    + 機械学習ワークロードのスケーラブルなオンデマンド コンピューティング。
    + 幅広いソースからデータを取り込むためのデータ ストレージと接続。
    + モデルのトレーニング、デプロイ、管理のプロセスを自動化するための、機械学習ワークフローの調整。
    + モデルの登録と管理。これにより、複数のバージョンのモデルと、それらのモデルをトレーニングしたデータを追跡できます。
    + トレーニングの実験、データセット、公開されたサービスのメトリックと監視。
    + リアルタイムおよびバッチ推論のためのモデル デプロイ。
* Azure Machine Learning で Azure Databricks の実験を実行する
    + MLflow Tracking を使用して、実験の実行メトリックを追跡し、Azure Machine Learning ワークスペース内にモデル成果物を保存する
    1. MLflow の追跡 URI を構成して AML を使用する。
        + AML ワークスペース オブジェクトを取得する。
        + AML ワークスペース オブジェクトから、一意の追跡 URI アドレスを取得する。
        + AML ワークスペースを指す MLflow の 追跡 URI を設定する
    2. MLflow 実験を構成する。
    3. 実験を実行します。
* MLflow を使用して Azure Machine Learning でメトリックをログする
* Azure Databricks コンピューティングで Azure Machine Learning パイプラインを実行する
    + Azure Machine Learning では、"パイプライン" は、各タスクが 1 つの "ステップ" として実装される機械学習タスクのワークフローです
    1. Azure Machine Learning ワークスペースに Azure Databricks コンピューティングをアタッチする。
    2. パイプラインで DatabricksStep を定義する。
    3. パイプラインを送信します。
#### Azure Machine Learning に Azure Databricks モデルをデプロイする
* モデル デプロイに関する考慮事項について説明する。
    + リアルタイムの推論
* デプロイ エンドポイントを計画する。
    + 使用可能なコンピューティング先
        - ローカル Web サービス
        - Azure Kubernetes Service (AKS)        
        - Azure Container Instances (ACI)        
        - Azure Machine Learning コンピューティング クラスター        
        - Azure IoT Edge        
* モデルを推論 Web サービスとしてデプロイする。
    1. トレーニング済みモデルを登録する。
    2. 推論の構成を定義する。
        + モデルを読み込み、送信されたデータの予測を返すスクリプト。
        + スクリプトが実行される環境。
    3. デプロイの構成を定義する。
    4. モデルをデプロイする。
* モデル デプロイのトラブルシューティングを行う。
    + サービスの状態を確認する
    + サービス ログを確認する
    + ローカル コンテナーにデプロイする
#### Azure Databricks でハイパーパラメーターを調整する
* 機械学習でのハイパーパラメーターのチューニングとその役割について理解します。
    + ハイパーパラメーターの調整
        - 損失関数で最適な結果が得られるハイパーパラメーターを選択するプロセス、または間違っているアルゴリズムにペナルティを課す方法
    + クロス検証
        - 
    + オーバーフィット
        - 既に見たことのあるデータではモデルは優れたパフォーマンスを示しますが、まだ見たことのないデータで何か役に立つことを予測しようとすると失敗する状態のこと
* 2 つのオープンソース ツール (自動 MLflow と Hyperopt) を使用して、モデルの選択とハイパーパラメーターのチューニングのプロセスを自動化する方法について学習します。
    + 自動 MLflow 追跡。
        - Python ノートブックを使ってコードをホストします。
        - Databricks Runtime または Databricks Runtime for Machine Learning でノートブックをクラスターにアタッチします。
        - CrossValidator または TrainValidationSplit を使ってハイパーパラメーターのチューニングを設定します。
    + Hyperopt でのハイパーパラメーターのチューニング。
        - 特定のアルゴリズムで使用可能なハイパーパラメーターの一覧を表示します。
        - 検索空間とサンプリング方法を設定します。
        - CrossValidator または TrainValidationSplit を使って、自動 MLflow でコードを実行します。
        1. 最小化する目的の関数を定義します。
        2. ハイパーパラメーター検索空間を定義します。
        3. 検索アルゴリズムを指定します。
        4. Hyperopt の関数 fmin() を実行します。
#### Horovod と Azure Databricks を使用した分散ディープ ラーニング
* Horovod とは何か、およびそれがディープ ラーニング モデルを分散させるのにどのように役立つのかを理解します。
    + ディープ ラーニングのクイック レビュー
    + Azure Databricks を使用したディープ ラーニング
    + Horovod を理解する
* 分散ディープ ラーニングには、Azure Databricks で HorovodRunner を使用します。
    + HorovodRunner を使用して Azure Databricks で Horovod をトリガーする
    + Horovod プロセス
        - TensorFlow、Keras、または PyTorch を使い、単一ノードのコードを準備してテストします。
        - コードを Horovod に移行します。
        - HorovodRunner を使ってコードを実行し、作業を分散させます。

## モデルのデプロイと再トレーニング (10 - 15%)


https://github.com/MicrosoftLearning/DP-100JA-Designing-and-Implementing-a-Data-Science-Solution/blob/master/labdocs/README.md


## その他
### Scikit-learn